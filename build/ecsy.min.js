!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e=e||self,function(){var n=e.ECSY,s=e.ECSY={};t(s),s.noConflict=function(){return e.ECSY=n,s}}())}(this,(function(e){"use strict";class t{constructor(e){this._systems=[],this._executeSystems=[],this.world=e,this.lastExecutedSystem=null}registerSystem(e,t){var n=new e(this.world,t);return n.init&&n.init(),n.order=this._systems.length,this._systems.push(n),n.execute&&this._executeSystems.push(n),this.sortSystems(),this}sortSystems(){this._executeSystems.sort((e,t)=>e.priority-t.priority||e.order-t.order)}getSystem(e){return this._systems.find(t=>t instanceof e)}getSystems(){return this._systems}removeSystem(e){var t=this._systems.indexOf(e);~t&&this._systems.splice(t,1)}executeSystem(e,t,n){if(e.initialized){if(e.canExecute()){let s=performance.now();e.execute(t,n),e.executeTime=performance.now()-s}this.lastExecutedSystem=e,e.clearEvents()}}execute(e,t,n){this._executeSystems.forEach(s=>(n||s.enabled)&&this.executeSystem(s,e,t))}stats(){for(var e={numSystems:this._systems.length,systems:{}},t=0;t<this._systems.length;t++){var n=this._systems[t],s=e.systems[n.constructor.name]={queries:{}};for(var o in n.ctx)s.queries[o]=n.ctx[o].stats()}return e}}class n{constructor(){this._listeners={},this.stats={fired:0,handled:0}}addEventListener(e,t){let n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){return void 0!==this._listeners[e]&&-1!==this._listeners[e].indexOf(t)}removeEventListener(e,t){var n=this._listeners[e];if(void 0!==n){var s=n.indexOf(t);-1!==s&&n.splice(s,1)}}dispatchEvent(e,t,n){this.stats.fired++;var s=this._listeners[e];if(void 0!==s)for(var o=s.slice(0),i=0;i<o.length;i++)o[i].call(this,t,n)}resetCounters(){this.stats.fired=this.stats.handled=0}}function s(e){return e.name}function o(e){var t=s(e);return t.charAt(0).toLowerCase()+t.slice(1)}function i(e){for(var t=[],n=0;n<e.length;n++){var o=e[n];if("object"==typeof o){var i="not"===o.operator?"!":o.operator;t.push(i+s(o.Component))}else t.push(s(o))}return t.map((function(e){return e.toLowerCase()})).sort().join("-")}class r{constructor(e,t){if(this.Components=[],this.NotComponents=[],e.forEach(e=>{"object"==typeof e?this.NotComponents.push(e.Component):this.Components.push(e)}),0===this.Components.length)throw new Error("Can't create a query without components");this.entities=[],this.eventDispatcher=new n,this.reactive=!1,this.key=i(e);for(var s=0;s<t._entities.length;s++){var o=t._entities[s];this.match(o)&&(o.queries.push(this),this.entities.push(o))}}addEntity(e){e.queries.push(this),this.entities.push(e),this.eventDispatcher.dispatchEvent(r.prototype.ENTITY_ADDED,e)}removeEntity(e){let t=this.entities.indexOf(e);~t&&(this.entities.splice(t,1),t=e.queries.indexOf(this),e.queries.splice(t,1),this.eventDispatcher.dispatchEvent(r.prototype.ENTITY_REMOVED,e))}match(e){return e.hasAllComponents(this.Components)&&!e.hasAnyComponents(this.NotComponents)}stats(){return{numComponents:this.Components.length,numEntities:this.entities.length}}}r.prototype.ENTITY_ADDED="Query#ENTITY_ADDED",r.prototype.ENTITY_REMOVED="Query#ENTITY_REMOVED",r.prototype.COMPONENT_CHANGED="Query#COMPONENT_CHANGED";var a=0;class h{constructor(e){this._world=e||null,this.id=a++,this._ComponentTypes=[],this._components={},this._componentsToRemove={},this.queries=[],this._ComponentTypesToRemove=[],this.alive=!1}getComponent(e){return this._components[e.name]}getRemovedComponent(e){return this._componentsToRemove[e.name]}getComponents(){return this._components}getComponentsToRemove(){return this._componentsToRemove}getComponentTypes(){return this._ComponentTypes}getMutableComponent(e){for(var t=this._components[e.name],n=0;n<this.queries.length;n++){var s=this.queries[n];s.reactive&&-1!==s.Components.indexOf(e)&&s.eventDispatcher.dispatchEvent(r.prototype.COMPONENT_CHANGED,this,t)}return t}addComponent(e,t){return this._world.entityAddComponent(this,e,t),this}removeComponent(e,t){return this._world.entityRemoveComponent(this,e,t),this}hasComponent(e){return!!~this._ComponentTypes.indexOf(e)}hasRemovedComponent(e){return!!~this._ComponentTypesToRemove.indexOf(e)}hasAllComponents(e){for(var t=0;t<e.length;t++)if(!this.hasComponent(e[t]))return!1;return!0}hasAnyComponents(e){for(var t=0;t<e.length;t++)if(this.hasComponent(e[t]))return!0;return!1}removeAllComponents(e){return this._world.entityRemoveAllComponents(this,e)}reset(){this.id=a++,this._world=null,this._ComponentTypes.length=0,this.queries.length=0,this._components={}}remove(e){return this._world.removeEntity(this,e)}}class p{constructor(e,t){this.freeList=[],this.count=0,this.T=e,this.isObjectPool=!0;var n=null;arguments.length>1&&(n=Array.prototype.slice.call(arguments)).shift(),this.createElement=n?()=>new e(...n):()=>new e,void 0!==t&&this.expand(t)}aquire(){return this.freeList.length<=0&&this.expand(Math.round(.2*this.count)+1),this.freeList.pop()}release(e){e.reset(),this.freeList.push(e)}expand(e){for(var t=0;t<e;t++)this.freeList.push(this.createElement());this.count+=e}totalSize(){return this.count}totalFree(){return this.freeList.length}totalUsed(){return this.count-this.freeList.length}}class m{constructor(e){this._world=e,this._queries={}}onEntityRemoved(e){for(var t in this._queries){var n=this._queries[t];-1!==e.queries.indexOf(n)&&n.removeEntity(e)}}onEntityComponentAdded(e,t){for(var n in this._queries){var s=this._queries[n];~s.NotComponents.indexOf(t)&&~s.entities.indexOf(e)?s.removeEntity(e):~s.Components.indexOf(t)&&s.match(e)&&!~s.entities.indexOf(e)&&s.addEntity(e)}}onEntityComponentRemoved(e,t){for(var n in this._queries){var s=this._queries[n];~s.NotComponents.indexOf(t)&&!~s.entities.indexOf(e)&&s.match(e)?s.addEntity(e):~s.Components.indexOf(t)&&~s.entities.indexOf(e)&&!s.match(e)&&s.removeEntity(e)}}getQuery(e){var t=i(e),n=this._queries[t];return n||(this._queries[t]=n=new r(e,this._world)),n}stats(){var e={};for(var t in this._queries)e[t]=this._queries[t].stats();return e}}class l{}class c{constructor(e){this.world=e,this.componentsManager=e.componentsManager,this._entities=[],this._queryManager=new m(this),this.eventDispatcher=new n,this._entityPool=new p(h),this.entitiesWithComponentsToRemove=[],this.entitiesToRemove=[],this.numStateComponents=0}createEntity(){var e=this._entityPool.aquire();return e.alive=!0,e._world=this,this._entities.push(e),this.eventDispatcher.dispatchEvent(u,e),e}entityAddComponent(e,t,n){if(!~e._ComponentTypes.indexOf(t)){e._ComponentTypes.push(t),t.__proto__===l&&this.numStateComponents++;var s=this.world.componentsManager.getComponentsPool(t).aquire();if(e._components[t.name]=s,n)if(s.copy)s.copy(n);else for(var o in n)s[o]=n[o];this._queryManager.onEntityComponentAdded(e,t),this.world.componentsManager.componentAddedToEntity(t),this.eventDispatcher.dispatchEvent(d,e,t)}}entityRemoveComponent(e,t,n){var o=e._ComponentTypes.indexOf(t);if(~o){if(this.eventDispatcher.dispatchEvent(v,e,t),n)this._entityRemoveComponentSync(e,t,o);else{0===e._ComponentTypesToRemove.length&&this.entitiesWithComponentsToRemove.push(e),e._ComponentTypes.splice(o,1),e._ComponentTypesToRemove.push(t);var i=s(t);e._componentsToRemove[i]=e._components[i],delete e._components[i]}this._queryManager.onEntityComponentRemoved(e,t),t.__proto__===l&&(this.numStateComponents--,0!==this.numStateComponents||e.alive||e.remove())}}_entityRemoveComponentSync(e,t,n){e._ComponentTypes.splice(n,1);var i=o(t),r=s(t),a=e._components[r];delete e._components[r],this.componentsManager._componentPool[i].release(a),this.world.componentsManager.componentRemovedFromEntity(t)}entityRemoveAllComponents(e,t){let n=e._ComponentTypes;for(let s=n.length-1;s>=0;s--)n[s].__proto__!==l&&this.entityRemoveComponent(e,n[s],t)}removeEntity(e,t){var n=this._entities.indexOf(e);if(!~n)throw new Error("Tried to remove entity not in list");e.alive=!1,0===this.numStateComponents&&(this.eventDispatcher.dispatchEvent(y,e),this._queryManager.onEntityRemoved(e),!0===t?this._releaseEntity(e,n):this.entitiesToRemove.push(e)),this.entityRemoveAllComponents(e,t)}_releaseEntity(e,t){this._entities.splice(t,1),e._world=null,this._entityPool.release(e)}removeAllEntities(){for(var e=this._entities.length-1;e>=0;e--)this.removeEntity(this._entities[e])}processDeferredRemoval(){for(let e=0;e<this.entitiesToRemove.length;e++){let t=this.entitiesToRemove[e],n=this._entities.indexOf(t);this._releaseEntity(t,n)}this.entitiesToRemove.length=0;for(let i=0;i<this.entitiesWithComponentsToRemove.length;i++){let r=this.entitiesWithComponentsToRemove[i];for(;r._ComponentTypesToRemove.length>0;){let i=r._ComponentTypesToRemove.pop();var e=o(i),t=s(i),n=r._componentsToRemove[t];delete r._componentsToRemove[t],this.componentsManager._componentPool[e].release(n),this.world.componentsManager.componentRemovedFromEntity(i)}}this.entitiesWithComponentsToRemove.length=0}queryComponents(e){return this._queryManager.getQuery(e)}count(){return this._entities.length}stats(){var e={numEntities:this._entities.length,numQueries:Object.keys(this._queryManager._queries).length,queries:this._queryManager.stats(),numComponentPool:Object.keys(this.componentsManager._componentPool).length,componentPool:{},eventDispatcher:this.eventDispatcher.stats};for(var t in this.componentsManager._componentPool){var n=this.componentsManager._componentPool[t];e.componentPool[t]={used:n.totalUsed(),size:n.count}}return e}}const u="EntityManager#ENTITY_CREATE",y="EntityManager#ENTITY_REMOVED",d="EntityManager#COMPONENT_ADDED",v="EntityManager#COMPONENT_REMOVE";class f{constructor(e){this.isDummyObjectPool=!0,this.count=0,this.used=0,this.T=e}aquire(){return this.used++,this.count++,new this.T}release(){this.used--}totalSize(){return this.count}totalFree(){return 1/0}totalUsed(){return this.used}}class _{constructor(){this.Components={},this._componentPool={},this.numComponents={}}registerComponent(e){this.Components[e.name]=e,this.numComponents[e.name]=0}componentAddedToEntity(e){this.numComponents[e.name]?this.numComponents[e.name]++:this.numComponents[e.name]=1}componentRemovedFromEntity(e){this.numComponents[e.name]--}getComponentsPool(e){var t=o(e);return this._componentPool[t]||(e.prototype.reset?this._componentPool[t]=new p(e):(console.warn(`Component '${e.name}' won't benefit from pooling because 'reset' method was not implemeneted.`),this._componentPool[t]=new f(e))),this._componentPool[t]}}function C(e){var t=["create","reset","clear"].filter(t=>!e[t]);if(t.length>0)throw new Error(`createType expect type definition to implements the following functions: ${t.join(", ")}`);return e.isType=!0,e}var g={};g.Number=C({baseType:Number,isSimpleType:!0,create:e=>void 0!==e?e:0,reset:(e,t,n)=>{e[t]=void 0!==n?n:0},clear:(e,t)=>{e[t]=0}}),g.Boolean=C({baseType:Boolean,isSimpleType:!0,create:e=>void 0!==e&&e,reset:(e,t,n)=>{e[t]=void 0!==n&&n},clear:(e,t)=>{e[t]=!1}}),g.String=C({baseType:String,isSimpleType:!0,create:e=>void 0!==e?e:"",reset:(e,t,n)=>{e[t]=void 0!==n?n:""},clear:(e,t)=>{e[t]=""}}),g.Array=C({baseType:Array,create:e=>void 0!==e?e.slice():[],reset:(e,t,n)=>{void 0!==n?e[t]=n.slice():e[t].length=0},clear:(e,t)=>{e[t].length=0},copy:(e,t,n)=>{e[n]=t[n].slice()}});var E={number:g.Number,boolean:g.Boolean,string:g.String};function T(e){return Array.isArray(e)?g.Array:E[typeof e]?E[typeof e]:null}e.Component=class{},e.Not=function(e){return{operator:"not",Component:e}},e.System=class{canExecute(){if(0===this._mandatoryQueries.length)return!0;for(let e=0;e<this._mandatoryQueries.length;e++){if(0===this._mandatoryQueries[e].entities.length)return!1}return!0}constructor(e,t){if(this.world=e,this.enabled=!0,this._queries={},this.queries={},this.priority=0,this.executeTime=0,t&&t.priority&&(this.priority=t.priority),this._mandatoryQueries=[],this.initialized=!0,this.constructor.queries)for(var n in this.constructor.queries){var s=this.constructor.queries[n],o=s.components;if(!o||0===o.length)throw new Error("'components' attribute can't be empty in a query");var i=this.world.entityManager.queryComponents(o);this._queries[n]=i,!0===s.mandatory&&this._mandatoryQueries.push(i),this.queries[n]={results:i.entities};const e={added:r.prototype.ENTITY_ADDED,removed:r.prototype.ENTITY_REMOVED,changed:r.prototype.COMPONENT_CHANGED};s.listen&&["added","removed","changed"].forEach(t=>{if(s.listen[t]){let o=s.listen[t];if("changed"===t){if(i.reactive=!0,!0===o){let e=this.queries[n][t]=[];i.eventDispatcher.addEventListener(r.prototype.COMPONENT_CHANGED,t=>{-1===e.indexOf(t)&&e.push(t)})}else if(Array.isArray(o)){let e=this.queries[n][t]=[];i.eventDispatcher.addEventListener(r.prototype.COMPONENT_CHANGED,(t,n)=>{-1!==o.indexOf(n.constructor)&&-1===e.indexOf(t)&&e.push(t)})}}else{let s=this.queries[n][t]=[];i.eventDispatcher.addEventListener(e[t],e=>{-1===s.indexOf(e)&&s.push(e)})}}})}}stop(){this.executeTime=0,this.enabled=!1}play(){this.enabled=!0}clearEvents(){for(let t in this.queries){var e=this.queries[t];if(e.added&&(e.added.length=0),e.removed&&(e.removed.length=0),e.changed)if(Array.isArray(e.changed))e.changed.length=0;else for(let t in e.changed)e.changed[t].length=0}}toJSON(){var e={name:this.constructor.name,enabled:this.enabled,executeTime:this.executeTime,priority:this.priority,queries:{}};if(this.constructor.queries){var t=this.constructor.queries;for(let n in t){let s=t[n];e.queries[n]={key:this._queries[n].key},e.queries[n].mandatory=!0===s.mandatory}}return e}},e.SystemStateComponent=l,e.TagComponent=class{reset(){}},e.Types=g,e.World=class{constructor(){if(this.componentsManager=new _(this),this.entityManager=new c(this),this.systemManager=new t(this),this.enabled=!0,this.eventQueues={},"undefined"!=typeof CustomEvent){var e=new CustomEvent("ecsy-world-created",{detail:this});window.dispatchEvent(e)}}registerComponent(e){return this.componentsManager.registerComponent(e),this}registerSystem(e,t){return this.systemManager.registerSystem(e,t),this}getSystem(e){return this.systemManager.getSystem(e)}getSystems(){return this.systemManager.getSystems()}execute(e,t){this.enabled&&(this.systemManager.execute(e,t),this.entityManager.processDeferredRemoval())}stop(){this.enabled=!1}play(){this.enabled=!0}createEntity(){return this.entityManager.createEntity()}stats(){var e={entities:this.entityManager.stats(),system:this.systemManager.stats()};console.log(JSON.stringify(e,null,2))}},e.createComponentClass=function(e,t){for(let t in e){e[t].type||(e[t].type=T(e[t].default))}var n=function(){for(let n in e){var t=e[n];let s=t.type;s&&s.isType?this[n]=s.create(t.default):this[n]=t.default}};void 0!==t&&Object.defineProperty(n,"name",{value:t}),n.prototype.schema=e;var s=!0;for(let t in e){var o=e[t];o.type||(o.type=T(o.default)),o.type||(console.warn(`Unknown type definition for attribute '${t}'`),s=!1)}if(s){n.prototype.copy=function(t){for(let n in e)if(t[n]){let s=e[n].type;s.isSimpleType?this[n]=t[n]:s.copy?s.copy(this,t,n):console.warn(`Unknown copy function for attribute '${n}' data type`)}},n.prototype.reset=function(){for(let t in e){let n=e[t],s=n.type;s.reset&&s.reset(this,t,n.default)}},n.prototype.clear=function(){for(let t in e){let n=e[t].type;n.clear&&n.clear(this,t)}};for(let t in e){let s=e[t],o=s.type;n.prototype[t]=s.default,o.reset&&o.reset(n.prototype,t,s.default)}}else for(var i in console.warn("This component can't use pooling because some data types are not registered. Please provide a type created with 'createType'"),e){let t=e[i];n.prototype[i]=t.default}return n},e.createType=C,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWNzeS5taW4uanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9TeXN0ZW1NYW5hZ2VyLmpzIiwiLi4vc3JjL0V2ZW50RGlzcGF0Y2hlci5qcyIsIi4uL3NyYy9VdGlscy5qcyIsIi4uL3NyYy9RdWVyeS5qcyIsIi4uL3NyYy9FbnRpdHkuanMiLCIuLi9zcmMvT2JqZWN0UG9vbC5qcyIsIi4uL3NyYy9RdWVyeU1hbmFnZXIuanMiLCIuLi9zcmMvU3lzdGVtU3RhdGVDb21wb25lbnQuanMiLCIuLi9zcmMvRW50aXR5TWFuYWdlci5qcyIsIi4uL3NyYy9EdW1teU9iamVjdFBvb2wuanMiLCIuLi9zcmMvQ29tcG9uZW50TWFuYWdlci5qcyIsIi4uL3NyYy9DcmVhdGVUeXBlLmpzIiwiLi4vc3JjL1N0YW5kYXJkVHlwZXMuanMiLCIuLi9zcmMvSW5mZXJUeXBlLmpzIiwiLi4vc3JjL0NvbXBvbmVudC5qcyIsIi4uL3NyYy9TeXN0ZW0uanMiLCIuLi9zcmMvVGFnQ29tcG9uZW50LmpzIiwiLi4vc3JjL1dvcmxkLmpzIiwiLi4vc3JjL0NyZWF0ZUNvbXBvbmVudENsYXNzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBTeXN0ZW1NYW5hZ2VyIHtcbiAgY29uc3RydWN0b3Iod29ybGQpIHtcbiAgICB0aGlzLl9zeXN0ZW1zID0gW107XG4gICAgdGhpcy5fZXhlY3V0ZVN5c3RlbXMgPSBbXTsgLy8gU3lzdGVtcyB0aGF0IGhhdmUgYGV4ZWN1dGVgIG1ldGhvZFxuICAgIHRoaXMud29ybGQgPSB3b3JsZDtcbiAgICB0aGlzLmxhc3RFeGVjdXRlZFN5c3RlbSA9IG51bGw7XG4gIH1cblxuICByZWdpc3RlclN5c3RlbShTeXN0ZW0sIGF0dHJpYnV0ZXMpIHtcbiAgICB2YXIgc3lzdGVtID0gbmV3IFN5c3RlbSh0aGlzLndvcmxkLCBhdHRyaWJ1dGVzKTtcbiAgICBpZiAoc3lzdGVtLmluaXQpIHN5c3RlbS5pbml0KCk7XG4gICAgc3lzdGVtLm9yZGVyID0gdGhpcy5fc3lzdGVtcy5sZW5ndGg7XG4gICAgdGhpcy5fc3lzdGVtcy5wdXNoKHN5c3RlbSk7XG4gICAgaWYgKHN5c3RlbS5leGVjdXRlKSB0aGlzLl9leGVjdXRlU3lzdGVtcy5wdXNoKHN5c3RlbSk7XG4gICAgdGhpcy5zb3J0U3lzdGVtcygpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgc29ydFN5c3RlbXMoKSB7XG4gICAgdGhpcy5fZXhlY3V0ZVN5c3RlbXMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgcmV0dXJuIGEucHJpb3JpdHkgLSBiLnByaW9yaXR5IHx8IGEub3JkZXIgLSBiLm9yZGVyO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0U3lzdGVtKFN5c3RlbSkge1xuICAgIHJldHVybiB0aGlzLl9zeXN0ZW1zLmZpbmQocyA9PiBzIGluc3RhbmNlb2YgU3lzdGVtKTtcbiAgfVxuXG4gIGdldFN5c3RlbXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3N5c3RlbXM7XG4gIH1cblxuICByZW1vdmVTeXN0ZW0oU3lzdGVtKSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy5fc3lzdGVtcy5pbmRleE9mKFN5c3RlbSk7XG4gICAgaWYgKCF+aW5kZXgpIHJldHVybjtcblxuICAgIHRoaXMuX3N5c3RlbXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgfVxuXG4gIGV4ZWN1dGVTeXN0ZW0oc3lzdGVtLCBkZWx0YSwgdGltZSkge1xuICAgIGlmIChzeXN0ZW0uaW5pdGlhbGl6ZWQpIHtcbiAgICAgIGlmIChzeXN0ZW0uY2FuRXhlY3V0ZSgpKSB7XG4gICAgICAgIGxldCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgc3lzdGVtLmV4ZWN1dGUoZGVsdGEsIHRpbWUpO1xuICAgICAgICBzeXN0ZW0uZXhlY3V0ZVRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIH1cbiAgICAgIHRoaXMubGFzdEV4ZWN1dGVkU3lzdGVtID0gc3lzdGVtO1xuICAgICAgc3lzdGVtLmNsZWFyRXZlbnRzKCk7XG4gICAgfVxuICB9XG5cbiAgZXhlY3V0ZShkZWx0YSwgdGltZSwgZm9yY2VQbGF5KSB7XG4gICAgdGhpcy5fZXhlY3V0ZVN5c3RlbXMuZm9yRWFjaChcbiAgICAgIHN5c3RlbSA9PlxuICAgICAgICAoZm9yY2VQbGF5IHx8IHN5c3RlbS5lbmFibGVkKSAmJiB0aGlzLmV4ZWN1dGVTeXN0ZW0oc3lzdGVtLCBkZWx0YSwgdGltZSlcbiAgICApO1xuICB9XG5cbiAgc3RhdHMoKSB7XG4gICAgdmFyIHN0YXRzID0ge1xuICAgICAgbnVtU3lzdGVtczogdGhpcy5fc3lzdGVtcy5sZW5ndGgsXG4gICAgICBzeXN0ZW1zOiB7fVxuICAgIH07XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX3N5c3RlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBzeXN0ZW0gPSB0aGlzLl9zeXN0ZW1zW2ldO1xuICAgICAgdmFyIHN5c3RlbVN0YXRzID0gKHN0YXRzLnN5c3RlbXNbc3lzdGVtLmNvbnN0cnVjdG9yLm5hbWVdID0ge1xuICAgICAgICBxdWVyaWVzOiB7fVxuICAgICAgfSk7XG4gICAgICBmb3IgKHZhciBuYW1lIGluIHN5c3RlbS5jdHgpIHtcbiAgICAgICAgc3lzdGVtU3RhdHMucXVlcmllc1tuYW1lXSA9IHN5c3RlbS5jdHhbbmFtZV0uc3RhdHMoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3RhdHM7XG4gIH1cbn1cbiIsIi8qKlxuICogQHByaXZhdGVcbiAqIEBjbGFzcyBFdmVudERpc3BhdGNoZXJcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXZlbnREaXNwYXRjaGVyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5fbGlzdGVuZXJzID0ge307XG4gICAgdGhpcy5zdGF0cyA9IHtcbiAgICAgIGZpcmVkOiAwLFxuICAgICAgaGFuZGxlZDogMFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgTmFtZSBvZiB0aGUgZXZlbnQgdG8gbGlzdGVuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIENhbGxiYWNrIHRvIHRyaWdnZXIgd2hlbiB0aGUgZXZlbnQgaXMgZmlyZWRcbiAgICovXG4gIGFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgIGxldCBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnM7XG4gICAgaWYgKGxpc3RlbmVyc1tldmVudE5hbWVdID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGxpc3RlbmVyc1tldmVudE5hbWVdID0gW107XG4gICAgfVxuXG4gICAgaWYgKGxpc3RlbmVyc1tldmVudE5hbWVdLmluZGV4T2YobGlzdGVuZXIpID09PSAtMSkge1xuICAgICAgbGlzdGVuZXJzW2V2ZW50TmFtZV0ucHVzaChsaXN0ZW5lcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGFuIGV2ZW50IGxpc3RlbmVyIGlzIGFscmVhZHkgYWRkZWQgdG8gdGhlIGxpc3Qgb2YgbGlzdGVuZXJzXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgTmFtZSBvZiB0aGUgZXZlbnQgdG8gY2hlY2tcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgQ2FsbGJhY2sgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnRcbiAgICovXG4gIGhhc0V2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLl9saXN0ZW5lcnNbZXZlbnROYW1lXSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICB0aGlzLl9saXN0ZW5lcnNbZXZlbnROYW1lXS5pbmRleE9mKGxpc3RlbmVyKSAhPT0gLTFcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lclxuICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnROYW1lIE5hbWUgb2YgdGhlIGV2ZW50IHRvIHJlbW92ZVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBDYWxsYmFjayBmb3IgdGhlIHNwZWNpZmllZCBldmVudFxuICAgKi9cbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGxpc3RlbmVyQXJyYXkgPSB0aGlzLl9saXN0ZW5lcnNbZXZlbnROYW1lXTtcbiAgICBpZiAobGlzdGVuZXJBcnJheSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YXIgaW5kZXggPSBsaXN0ZW5lckFycmF5LmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBsaXN0ZW5lckFycmF5LnNwbGljZShpbmRleCwgMSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERpc3BhdGNoIGFuIGV2ZW50XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgTmFtZSBvZiB0aGUgZXZlbnQgdG8gZGlzcGF0Y2hcbiAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eSAoT3B0aW9uYWwpIEVudGl0eSB0byBlbWl0XG4gICAqIEBwYXJhbSB7Q29tcG9uZW50fSBjb21wb25lbnRcbiAgICovXG4gIGRpc3BhdGNoRXZlbnQoZXZlbnROYW1lLCBlbnRpdHksIGNvbXBvbmVudCkge1xuICAgIHRoaXMuc3RhdHMuZmlyZWQrKztcblxuICAgIHZhciBsaXN0ZW5lckFycmF5ID0gdGhpcy5fbGlzdGVuZXJzW2V2ZW50TmFtZV07XG4gICAgaWYgKGxpc3RlbmVyQXJyYXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFyIGFycmF5ID0gbGlzdGVuZXJBcnJheS5zbGljZSgwKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICBhcnJheVtpXS5jYWxsKHRoaXMsIGVudGl0eSwgY29tcG9uZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVzZXQgc3RhdHMgY291bnRlcnNcbiAgICovXG4gIHJlc2V0Q291bnRlcnMoKSB7XG4gICAgdGhpcy5zdGF0cy5maXJlZCA9IHRoaXMuc3RhdHMuaGFuZGxlZCA9IDA7XG4gIH1cbn1cbiIsIi8qKlxuICogUmV0dXJuIHRoZSBuYW1lIG9mIGEgY29tcG9uZW50XG4gKiBAcGFyYW0ge0NvbXBvbmVudH0gQ29tcG9uZW50XG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmFtZShDb21wb25lbnQpIHtcbiAgcmV0dXJuIENvbXBvbmVudC5uYW1lO1xufVxuXG4vKipcbiAqIFJldHVybiBhIHZhbGlkIHByb3BlcnR5IG5hbWUgZm9yIHRoZSBDb21wb25lbnRcbiAqIEBwYXJhbSB7Q29tcG9uZW50fSBDb21wb25lbnRcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb21wb25lbnRQcm9wZXJ0eU5hbWUoQ29tcG9uZW50KSB7XG4gIHZhciBuYW1lID0gZ2V0TmFtZShDb21wb25lbnQpO1xuICByZXR1cm4gbmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIG5hbWUuc2xpY2UoMSk7XG59XG5cbi8qKlxuICogR2V0IGEga2V5IGZyb20gYSBsaXN0IG9mIGNvbXBvbmVudHNcbiAqIEBwYXJhbSB7QXJyYXkoQ29tcG9uZW50KX0gQ29tcG9uZW50cyBBcnJheSBvZiBjb21wb25lbnRzIHRvIGdlbmVyYXRlIHRoZSBrZXlcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBxdWVyeUtleShDb21wb25lbnRzKSB7XG4gIHZhciBuYW1lcyA9IFtdO1xuICBmb3IgKHZhciBuID0gMDsgbiA8IENvbXBvbmVudHMubGVuZ3RoOyBuKyspIHtcbiAgICB2YXIgVCA9IENvbXBvbmVudHNbbl07XG4gICAgaWYgKHR5cGVvZiBUID09PSBcIm9iamVjdFwiKSB7XG4gICAgICB2YXIgb3BlcmF0b3IgPSBULm9wZXJhdG9yID09PSBcIm5vdFwiID8gXCIhXCIgOiBULm9wZXJhdG9yO1xuICAgICAgbmFtZXMucHVzaChvcGVyYXRvciArIGdldE5hbWUoVC5Db21wb25lbnQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmFtZXMucHVzaChnZXROYW1lKFQpKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmFtZXNcbiAgICAubWFwKGZ1bmN0aW9uKHgpIHtcbiAgICAgIHJldHVybiB4LnRvTG93ZXJDYXNlKCk7XG4gICAgfSlcbiAgICAuc29ydCgpXG4gICAgLmpvaW4oXCItXCIpO1xufVxuIiwiaW1wb3J0IEV2ZW50RGlzcGF0Y2hlciBmcm9tIFwiLi9FdmVudERpc3BhdGNoZXIuanNcIjtcbmltcG9ydCB7IHF1ZXJ5S2V5IH0gZnJvbSBcIi4vVXRpbHMuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUXVlcnkge1xuICAvKipcbiAgICogQHBhcmFtIHtBcnJheShDb21wb25lbnQpfSBDb21wb25lbnRzIExpc3Qgb2YgdHlwZXMgb2YgY29tcG9uZW50cyB0byBxdWVyeVxuICAgKi9cbiAgY29uc3RydWN0b3IoQ29tcG9uZW50cywgbWFuYWdlcikge1xuICAgIHRoaXMuQ29tcG9uZW50cyA9IFtdO1xuICAgIHRoaXMuTm90Q29tcG9uZW50cyA9IFtdO1xuXG4gICAgQ29tcG9uZW50cy5mb3JFYWNoKGNvbXBvbmVudCA9PiB7XG4gICAgICBpZiAodHlwZW9mIGNvbXBvbmVudCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICB0aGlzLk5vdENvbXBvbmVudHMucHVzaChjb21wb25lbnQuQ29tcG9uZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuQ29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5Db21wb25lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgY3JlYXRlIGEgcXVlcnkgd2l0aG91dCBjb21wb25lbnRzXCIpO1xuICAgIH1cblxuICAgIHRoaXMuZW50aXRpZXMgPSBbXTtcblxuICAgIHRoaXMuZXZlbnREaXNwYXRjaGVyID0gbmV3IEV2ZW50RGlzcGF0Y2hlcigpO1xuXG4gICAgLy8gVGhpcyBxdWVyeSBpcyBiZWluZyB1c2VkIGJ5IGEgcmVhY3RpdmUgc3lzdGVtXG4gICAgdGhpcy5yZWFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgdGhpcy5rZXkgPSBxdWVyeUtleShDb21wb25lbnRzKTtcblxuICAgIC8vIEZpbGwgdGhlIHF1ZXJ5IHdpdGggdGhlIGV4aXN0aW5nIGVudGl0aWVzXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYW5hZ2VyLl9lbnRpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGVudGl0eSA9IG1hbmFnZXIuX2VudGl0aWVzW2ldO1xuICAgICAgaWYgKHRoaXMubWF0Y2goZW50aXR5KSkge1xuICAgICAgICAvLyBAdG9kbyA/Pz8gdGhpcy5hZGRFbnRpdHkoZW50aXR5KTsgPT4gcHJldmVudGluZyB0aGUgZXZlbnQgdG8gYmUgZ2VuZXJhdGVkXG4gICAgICAgIGVudGl0eS5xdWVyaWVzLnB1c2godGhpcyk7XG4gICAgICAgIHRoaXMuZW50aXRpZXMucHVzaChlbnRpdHkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgZW50aXR5IHRvIHRoaXMgcXVlcnlcbiAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eVxuICAgKi9cbiAgYWRkRW50aXR5KGVudGl0eSkge1xuICAgIGVudGl0eS5xdWVyaWVzLnB1c2godGhpcyk7XG4gICAgdGhpcy5lbnRpdGllcy5wdXNoKGVudGl0eSk7XG5cbiAgICB0aGlzLmV2ZW50RGlzcGF0Y2hlci5kaXNwYXRjaEV2ZW50KFF1ZXJ5LnByb3RvdHlwZS5FTlRJVFlfQURERUQsIGVudGl0eSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGVudGl0eSBmcm9tIHRoaXMgcXVlcnlcbiAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eVxuICAgKi9cbiAgcmVtb3ZlRW50aXR5KGVudGl0eSkge1xuICAgIGxldCBpbmRleCA9IHRoaXMuZW50aXRpZXMuaW5kZXhPZihlbnRpdHkpO1xuICAgIGlmICh+aW5kZXgpIHtcbiAgICAgIHRoaXMuZW50aXRpZXMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgaW5kZXggPSBlbnRpdHkucXVlcmllcy5pbmRleE9mKHRoaXMpO1xuICAgICAgZW50aXR5LnF1ZXJpZXMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgdGhpcy5ldmVudERpc3BhdGNoZXIuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLkVOVElUWV9SRU1PVkVELFxuICAgICAgICBlbnRpdHlcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgbWF0Y2goZW50aXR5KSB7XG4gICAgcmV0dXJuIChcbiAgICAgIGVudGl0eS5oYXNBbGxDb21wb25lbnRzKHRoaXMuQ29tcG9uZW50cykgJiZcbiAgICAgICFlbnRpdHkuaGFzQW55Q29tcG9uZW50cyh0aGlzLk5vdENvbXBvbmVudHMpXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gc3RhdHMgZm9yIHRoaXMgcXVlcnlcbiAgICovXG4gIHN0YXRzKCkge1xuICAgIHJldHVybiB7XG4gICAgICBudW1Db21wb25lbnRzOiB0aGlzLkNvbXBvbmVudHMubGVuZ3RoLFxuICAgICAgbnVtRW50aXRpZXM6IHRoaXMuZW50aXRpZXMubGVuZ3RoXG4gICAgfTtcbiAgfVxufVxuXG5RdWVyeS5wcm90b3R5cGUuRU5USVRZX0FEREVEID0gXCJRdWVyeSNFTlRJVFlfQURERURcIjtcblF1ZXJ5LnByb3RvdHlwZS5FTlRJVFlfUkVNT1ZFRCA9IFwiUXVlcnkjRU5USVRZX1JFTU9WRURcIjtcblF1ZXJ5LnByb3RvdHlwZS5DT01QT05FTlRfQ0hBTkdFRCA9IFwiUXVlcnkjQ09NUE9ORU5UX0NIQU5HRURcIjtcbiIsImltcG9ydCBRdWVyeSBmcm9tIFwiLi9RdWVyeS5qc1wiO1xuaW1wb3J0IHdyYXBJbW11dGFibGVDb21wb25lbnQgZnJvbSBcIi4vV3JhcEltbXV0YWJsZUNvbXBvbmVudC5qc1wiO1xuXG4vLyBAdG9kbyBUYWtlIHRoaXMgb3V0IGZyb20gdGhlcmUgb3IgdXNlIEVOVlxuY29uc3QgREVCVUcgPSBmYWxzZTtcblxudmFyIG5leHRJZCA9IDA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudGl0eSB7XG4gIGNvbnN0cnVjdG9yKHdvcmxkKSB7XG4gICAgdGhpcy5fd29ybGQgPSB3b3JsZCB8fCBudWxsO1xuXG4gICAgLy8gVW5pcXVlIElEIGZvciB0aGlzIGVudGl0eVxuICAgIHRoaXMuaWQgPSBuZXh0SWQrKztcblxuICAgIC8vIExpc3Qgb2YgY29tcG9uZW50cyB0eXBlcyB0aGUgZW50aXR5IGhhc1xuICAgIHRoaXMuX0NvbXBvbmVudFR5cGVzID0gW107XG5cbiAgICAvLyBJbnN0YW5jZSBvZiB0aGUgY29tcG9uZW50c1xuICAgIHRoaXMuX2NvbXBvbmVudHMgPSB7fTtcblxuICAgIHRoaXMuX2NvbXBvbmVudHNUb1JlbW92ZSA9IHt9O1xuXG4gICAgLy8gUXVlcmllcyB3aGVyZSB0aGUgZW50aXR5IGlzIGFkZGVkXG4gICAgdGhpcy5xdWVyaWVzID0gW107XG5cbiAgICAvLyBVc2VkIGZvciBkZWZlcnJlZCByZW1vdmFsXG4gICAgdGhpcy5fQ29tcG9uZW50VHlwZXNUb1JlbW92ZSA9IFtdO1xuXG4gICAgdGhpcy5hbGl2ZSA9IGZhbHNlO1xuICB9XG5cbiAgLy8gQ09NUE9ORU5UU1xuXG4gIGdldENvbXBvbmVudChDb21wb25lbnQpIHtcbiAgICB2YXIgY29tcG9uZW50ID0gdGhpcy5fY29tcG9uZW50c1tDb21wb25lbnQubmFtZV07XG4gICAgcmV0dXJuIERFQlVHID8gd3JhcEltbXV0YWJsZUNvbXBvbmVudChDb21wb25lbnQsIGNvbXBvbmVudCkgOiBjb21wb25lbnQ7XG4gIH1cblxuICBnZXRSZW1vdmVkQ29tcG9uZW50KENvbXBvbmVudCkge1xuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRzVG9SZW1vdmVbQ29tcG9uZW50Lm5hbWVdO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5fY29tcG9uZW50cztcbiAgfVxuXG4gIGdldENvbXBvbmVudHNUb1JlbW92ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fY29tcG9uZW50c1RvUmVtb3ZlO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50VHlwZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX0NvbXBvbmVudFR5cGVzO1xuICB9XG5cbiAgZ2V0TXV0YWJsZUNvbXBvbmVudChDb21wb25lbnQpIHtcbiAgICB2YXIgY29tcG9uZW50ID0gdGhpcy5fY29tcG9uZW50c1tDb21wb25lbnQubmFtZV07XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnF1ZXJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBxdWVyeSA9IHRoaXMucXVlcmllc1tpXTtcbiAgICAgIC8vIEB0b2RvIGFjY2VsZXJhdGUgdGhpcyBjaGVjay4gTWF5YmUgaGF2aW5nIHF1ZXJ5Ll9Db21wb25lbnRzIGFzIGFuIG9iamVjdFxuICAgICAgaWYgKHF1ZXJ5LnJlYWN0aXZlICYmIHF1ZXJ5LkNvbXBvbmVudHMuaW5kZXhPZihDb21wb25lbnQpICE9PSAtMSkge1xuICAgICAgICBxdWVyeS5ldmVudERpc3BhdGNoZXIuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgICBRdWVyeS5wcm90b3R5cGUuQ09NUE9ORU5UX0NIQU5HRUQsXG4gICAgICAgICAgdGhpcyxcbiAgICAgICAgICBjb21wb25lbnRcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbiAgfVxuXG4gIGFkZENvbXBvbmVudChDb21wb25lbnQsIHZhbHVlcykge1xuICAgIHRoaXMuX3dvcmxkLmVudGl0eUFkZENvbXBvbmVudCh0aGlzLCBDb21wb25lbnQsIHZhbHVlcyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICByZW1vdmVDb21wb25lbnQoQ29tcG9uZW50LCBmb3JjZVJlbW92ZSkge1xuICAgIHRoaXMuX3dvcmxkLmVudGl0eVJlbW92ZUNvbXBvbmVudCh0aGlzLCBDb21wb25lbnQsIGZvcmNlUmVtb3ZlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGhhc0NvbXBvbmVudChDb21wb25lbnQpIHtcbiAgICByZXR1cm4gISF+dGhpcy5fQ29tcG9uZW50VHlwZXMuaW5kZXhPZihDb21wb25lbnQpO1xuICB9XG5cbiAgaGFzUmVtb3ZlZENvbXBvbmVudChDb21wb25lbnQpIHtcbiAgICByZXR1cm4gISF+dGhpcy5fQ29tcG9uZW50VHlwZXNUb1JlbW92ZS5pbmRleE9mKENvbXBvbmVudCk7XG4gIH1cblxuICBoYXNBbGxDb21wb25lbnRzKENvbXBvbmVudHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IENvbXBvbmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghdGhpcy5oYXNDb21wb25lbnQoQ29tcG9uZW50c1tpXSkpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBoYXNBbnlDb21wb25lbnRzKENvbXBvbmVudHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IENvbXBvbmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLmhhc0NvbXBvbmVudChDb21wb25lbnRzW2ldKSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJlbW92ZUFsbENvbXBvbmVudHMoZm9yY2VSZW1vdmUpIHtcbiAgICByZXR1cm4gdGhpcy5fd29ybGQuZW50aXR5UmVtb3ZlQWxsQ29tcG9uZW50cyh0aGlzLCBmb3JjZVJlbW92ZSk7XG4gIH1cblxuICAvLyBFWFRSQVNcblxuICAvLyBJbml0aWFsaXplIHRoZSBlbnRpdHkuIFRvIGJlIHVzZWQgd2hlbiByZXR1cm5pbmcgYW4gZW50aXR5IHRvIHRoZSBwb29sXG4gIHJlc2V0KCkge1xuICAgIHRoaXMuaWQgPSBuZXh0SWQrKztcbiAgICB0aGlzLl93b3JsZCA9IG51bGw7XG4gICAgdGhpcy5fQ29tcG9uZW50VHlwZXMubGVuZ3RoID0gMDtcbiAgICB0aGlzLnF1ZXJpZXMubGVuZ3RoID0gMDtcbiAgICB0aGlzLl9jb21wb25lbnRzID0ge307XG4gIH1cblxuICByZW1vdmUoZm9yY2VSZW1vdmUpIHtcbiAgICByZXR1cm4gdGhpcy5fd29ybGQucmVtb3ZlRW50aXR5KHRoaXMsIGZvcmNlUmVtb3ZlKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgT2JqZWN0UG9vbCB7XG4gIC8vIEB0b2RvIEFkZCBpbml0aWFsIHNpemVcbiAgY29uc3RydWN0b3IoVCwgaW5pdGlhbFNpemUpIHtcbiAgICB0aGlzLmZyZWVMaXN0ID0gW107XG4gICAgdGhpcy5jb3VudCA9IDA7XG4gICAgdGhpcy5UID0gVDtcbiAgICB0aGlzLmlzT2JqZWN0UG9vbCA9IHRydWU7XG5cbiAgICB2YXIgZXh0cmFBcmdzID0gbnVsbDtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgIGV4dHJhQXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gICAgICBleHRyYUFyZ3Muc2hpZnQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmNyZWF0ZUVsZW1lbnQgPSBleHRyYUFyZ3NcbiAgICAgID8gKCkgPT4ge1xuICAgICAgICAgIHJldHVybiBuZXcgVCguLi5leHRyYUFyZ3MpO1xuICAgICAgICB9XG4gICAgICA6ICgpID0+IHtcbiAgICAgICAgICByZXR1cm4gbmV3IFQoKTtcbiAgICAgICAgfTtcblxuICAgIGlmICh0eXBlb2YgaW5pdGlhbFNpemUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHRoaXMuZXhwYW5kKGluaXRpYWxTaXplKTtcbiAgICB9XG4gIH1cblxuICBhcXVpcmUoKSB7XG4gICAgLy8gR3JvdyB0aGUgbGlzdCBieSAyMCVpc2ggaWYgd2UncmUgb3V0XG4gICAgaWYgKHRoaXMuZnJlZUxpc3QubGVuZ3RoIDw9IDApIHtcbiAgICAgIHRoaXMuZXhwYW5kKE1hdGgucm91bmQodGhpcy5jb3VudCAqIDAuMikgKyAxKTtcbiAgICB9XG5cbiAgICB2YXIgaXRlbSA9IHRoaXMuZnJlZUxpc3QucG9wKCk7XG5cbiAgICByZXR1cm4gaXRlbTtcbiAgfVxuXG4gIHJlbGVhc2UoaXRlbSkge1xuICAgIGl0ZW0ucmVzZXQoKTtcbiAgICB0aGlzLmZyZWVMaXN0LnB1c2goaXRlbSk7XG4gIH1cblxuICBleHBhbmQoY291bnQpIHtcbiAgICBmb3IgKHZhciBuID0gMDsgbiA8IGNvdW50OyBuKyspIHtcbiAgICAgIHRoaXMuZnJlZUxpc3QucHVzaCh0aGlzLmNyZWF0ZUVsZW1lbnQoKSk7XG4gICAgfVxuICAgIHRoaXMuY291bnQgKz0gY291bnQ7XG4gIH1cblxuICB0b3RhbFNpemUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY291bnQ7XG4gIH1cblxuICB0b3RhbEZyZWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZnJlZUxpc3QubGVuZ3RoO1xuICB9XG5cbiAgdG90YWxVc2VkKCkge1xuICAgIHJldHVybiB0aGlzLmNvdW50IC0gdGhpcy5mcmVlTGlzdC5sZW5ndGg7XG4gIH1cbn1cbiIsImltcG9ydCBRdWVyeSBmcm9tIFwiLi9RdWVyeS5qc1wiO1xuaW1wb3J0IHsgcXVlcnlLZXkgfSBmcm9tIFwiLi9VdGlscy5qc1wiO1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKiBAY2xhc3MgUXVlcnlNYW5hZ2VyXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFF1ZXJ5TWFuYWdlciB7XG4gIGNvbnN0cnVjdG9yKHdvcmxkKSB7XG4gICAgdGhpcy5fd29ybGQgPSB3b3JsZDtcblxuICAgIC8vIFF1ZXJpZXMgaW5kZXhlZCBieSBhIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgY29tcG9uZW50cyBpdCBoYXNcbiAgICB0aGlzLl9xdWVyaWVzID0ge307XG4gIH1cblxuICBvbkVudGl0eVJlbW92ZWQoZW50aXR5KSB7XG4gICAgZm9yICh2YXIgcXVlcnlOYW1lIGluIHRoaXMuX3F1ZXJpZXMpIHtcbiAgICAgIHZhciBxdWVyeSA9IHRoaXMuX3F1ZXJpZXNbcXVlcnlOYW1lXTtcbiAgICAgIGlmIChlbnRpdHkucXVlcmllcy5pbmRleE9mKHF1ZXJ5KSAhPT0gLTEpIHtcbiAgICAgICAgcXVlcnkucmVtb3ZlRW50aXR5KGVudGl0eSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIHdoZW4gYSBjb21wb25lbnQgaXMgYWRkZWQgdG8gYW4gZW50aXR5XG4gICAqIEBwYXJhbSB7RW50aXR5fSBlbnRpdHkgRW50aXR5IHRoYXQganVzdCBnb3QgdGhlIG5ldyBjb21wb25lbnRcbiAgICogQHBhcmFtIHtDb21wb25lbnR9IENvbXBvbmVudCBDb21wb25lbnQgYWRkZWQgdG8gdGhlIGVudGl0eVxuICAgKi9cbiAgb25FbnRpdHlDb21wb25lbnRBZGRlZChlbnRpdHksIENvbXBvbmVudCkge1xuICAgIC8vIEB0b2RvIFVzZSBiaXRtYXNrIGZvciBjaGVja2luZyBjb21wb25lbnRzP1xuXG4gICAgLy8gQ2hlY2sgZWFjaCBpbmRleGVkIHF1ZXJ5IHRvIHNlZSBpZiB3ZSBuZWVkIHRvIGFkZCB0aGlzIGVudGl0eSB0byB0aGUgbGlzdFxuICAgIGZvciAodmFyIHF1ZXJ5TmFtZSBpbiB0aGlzLl9xdWVyaWVzKSB7XG4gICAgICB2YXIgcXVlcnkgPSB0aGlzLl9xdWVyaWVzW3F1ZXJ5TmFtZV07XG5cbiAgICAgIGlmIChcbiAgICAgICAgISF+cXVlcnkuTm90Q29tcG9uZW50cy5pbmRleE9mKENvbXBvbmVudCkgJiZcbiAgICAgICAgfnF1ZXJ5LmVudGl0aWVzLmluZGV4T2YoZW50aXR5KVxuICAgICAgKSB7XG4gICAgICAgIHF1ZXJ5LnJlbW92ZUVudGl0eShlbnRpdHkpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIHRoZSBlbnRpdHkgb25seSBpZjpcbiAgICAgIC8vIENvbXBvbmVudCBpcyBpbiB0aGUgcXVlcnlcbiAgICAgIC8vIGFuZCBFbnRpdHkgaGFzIEFMTCB0aGUgY29tcG9uZW50cyBvZiB0aGUgcXVlcnlcbiAgICAgIC8vIGFuZCBFbnRpdHkgaXMgbm90IGFscmVhZHkgaW4gdGhlIHF1ZXJ5XG4gICAgICBpZiAoXG4gICAgICAgICF+cXVlcnkuQ29tcG9uZW50cy5pbmRleE9mKENvbXBvbmVudCkgfHxcbiAgICAgICAgIXF1ZXJ5Lm1hdGNoKGVudGl0eSkgfHxcbiAgICAgICAgfnF1ZXJ5LmVudGl0aWVzLmluZGV4T2YoZW50aXR5KVxuICAgICAgKVxuICAgICAgICBjb250aW51ZTtcblxuICAgICAgcXVlcnkuYWRkRW50aXR5KGVudGl0eSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIHdoZW4gYSBjb21wb25lbnQgaXMgcmVtb3ZlZCBmcm9tIGFuIGVudGl0eVxuICAgKiBAcGFyYW0ge0VudGl0eX0gZW50aXR5IEVudGl0eSB0byByZW1vdmUgdGhlIGNvbXBvbmVudCBmcm9tXG4gICAqIEBwYXJhbSB7Q29tcG9uZW50fSBDb21wb25lbnQgQ29tcG9uZW50IHRvIHJlbW92ZSBmcm9tIHRoZSBlbnRpdHlcbiAgICovXG4gIG9uRW50aXR5Q29tcG9uZW50UmVtb3ZlZChlbnRpdHksIENvbXBvbmVudCkge1xuICAgIGZvciAodmFyIHF1ZXJ5TmFtZSBpbiB0aGlzLl9xdWVyaWVzKSB7XG4gICAgICB2YXIgcXVlcnkgPSB0aGlzLl9xdWVyaWVzW3F1ZXJ5TmFtZV07XG5cbiAgICAgIGlmIChcbiAgICAgICAgISF+cXVlcnkuTm90Q29tcG9uZW50cy5pbmRleE9mKENvbXBvbmVudCkgJiZcbiAgICAgICAgIX5xdWVyeS5lbnRpdGllcy5pbmRleE9mKGVudGl0eSkgJiZcbiAgICAgICAgcXVlcnkubWF0Y2goZW50aXR5KVxuICAgICAgKSB7XG4gICAgICAgIHF1ZXJ5LmFkZEVudGl0eShlbnRpdHkpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKFxuICAgICAgICAhIX5xdWVyeS5Db21wb25lbnRzLmluZGV4T2YoQ29tcG9uZW50KSAmJlxuICAgICAgICAhIX5xdWVyeS5lbnRpdGllcy5pbmRleE9mKGVudGl0eSkgJiZcbiAgICAgICAgIXF1ZXJ5Lm1hdGNoKGVudGl0eSlcbiAgICAgICkge1xuICAgICAgICBxdWVyeS5yZW1vdmVFbnRpdHkoZW50aXR5KTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhIHF1ZXJ5IGZvciB0aGUgc3BlY2lmaWVkIGNvbXBvbmVudHNcbiAgICogQHBhcmFtIHtDb21wb25lbnR9IENvbXBvbmVudHMgQ29tcG9uZW50cyB0aGF0IHRoZSBxdWVyeSBzaG91bGQgaGF2ZVxuICAgKi9cbiAgZ2V0UXVlcnkoQ29tcG9uZW50cykge1xuICAgIHZhciBrZXkgPSBxdWVyeUtleShDb21wb25lbnRzKTtcbiAgICB2YXIgcXVlcnkgPSB0aGlzLl9xdWVyaWVzW2tleV07XG4gICAgaWYgKCFxdWVyeSkge1xuICAgICAgdGhpcy5fcXVlcmllc1trZXldID0gcXVlcnkgPSBuZXcgUXVlcnkoQ29tcG9uZW50cywgdGhpcy5fd29ybGQpO1xuICAgIH1cbiAgICByZXR1cm4gcXVlcnk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHNvbWUgc3RhdHMgZnJvbSB0aGlzIGNsYXNzXG4gICAqL1xuICBzdGF0cygpIHtcbiAgICB2YXIgc3RhdHMgPSB7fTtcbiAgICBmb3IgKHZhciBxdWVyeU5hbWUgaW4gdGhpcy5fcXVlcmllcykge1xuICAgICAgc3RhdHNbcXVlcnlOYW1lXSA9IHRoaXMuX3F1ZXJpZXNbcXVlcnlOYW1lXS5zdGF0cygpO1xuICAgIH1cbiAgICByZXR1cm4gc3RhdHM7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBTeXN0ZW1TdGF0ZUNvbXBvbmVudCB7fVxuIiwiaW1wb3J0IEVudGl0eSBmcm9tIFwiLi9FbnRpdHkuanNcIjtcbmltcG9ydCBPYmplY3RQb29sIGZyb20gXCIuL09iamVjdFBvb2wuanNcIjtcbmltcG9ydCBRdWVyeU1hbmFnZXIgZnJvbSBcIi4vUXVlcnlNYW5hZ2VyLmpzXCI7XG5pbXBvcnQgRXZlbnREaXNwYXRjaGVyIGZyb20gXCIuL0V2ZW50RGlzcGF0Y2hlci5qc1wiO1xuaW1wb3J0IHsgY29tcG9uZW50UHJvcGVydHlOYW1lLCBnZXROYW1lIH0gZnJvbSBcIi4vVXRpbHMuanNcIjtcbmltcG9ydCB7IFN5c3RlbVN0YXRlQ29tcG9uZW50IH0gZnJvbSBcIi4vU3lzdGVtU3RhdGVDb21wb25lbnQuanNcIjtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICogQGNsYXNzIEVudGl0eU1hbmFnZXJcbiAqL1xuZXhwb3J0IGNsYXNzIEVudGl0eU1hbmFnZXIge1xuICBjb25zdHJ1Y3Rvcih3b3JsZCkge1xuICAgIHRoaXMud29ybGQgPSB3b3JsZDtcbiAgICB0aGlzLmNvbXBvbmVudHNNYW5hZ2VyID0gd29ybGQuY29tcG9uZW50c01hbmFnZXI7XG5cbiAgICAvLyBBbGwgdGhlIGVudGl0aWVzIGluIHRoaXMgaW5zdGFuY2VcbiAgICB0aGlzLl9lbnRpdGllcyA9IFtdO1xuXG4gICAgdGhpcy5fcXVlcnlNYW5hZ2VyID0gbmV3IFF1ZXJ5TWFuYWdlcih0aGlzKTtcbiAgICB0aGlzLmV2ZW50RGlzcGF0Y2hlciA9IG5ldyBFdmVudERpc3BhdGNoZXIoKTtcbiAgICB0aGlzLl9lbnRpdHlQb29sID0gbmV3IE9iamVjdFBvb2woRW50aXR5KTtcblxuICAgIC8vIERlZmVycmVkIGRlbGV0aW9uXG4gICAgdGhpcy5lbnRpdGllc1dpdGhDb21wb25lbnRzVG9SZW1vdmUgPSBbXTtcbiAgICB0aGlzLmVudGl0aWVzVG9SZW1vdmUgPSBbXTtcblxuICAgIHRoaXMubnVtU3RhdGVDb21wb25lbnRzID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgZW50aXR5XG4gICAqL1xuICBjcmVhdGVFbnRpdHkoKSB7XG4gICAgdmFyIGVudGl0eSA9IHRoaXMuX2VudGl0eVBvb2wuYXF1aXJlKCk7XG4gICAgZW50aXR5LmFsaXZlID0gdHJ1ZTtcbiAgICBlbnRpdHkuX3dvcmxkID0gdGhpcztcbiAgICB0aGlzLl9lbnRpdGllcy5wdXNoKGVudGl0eSk7XG4gICAgdGhpcy5ldmVudERpc3BhdGNoZXIuZGlzcGF0Y2hFdmVudChFTlRJVFlfQ1JFQVRFRCwgZW50aXR5KTtcbiAgICByZXR1cm4gZW50aXR5O1xuICB9XG5cbiAgLy8gQ09NUE9ORU5UU1xuXG4gIC8qKlxuICAgKiBBZGQgYSBjb21wb25lbnQgdG8gYW4gZW50aXR5XG4gICAqIEBwYXJhbSB7RW50aXR5fSBlbnRpdHkgRW50aXR5IHdoZXJlIHRoZSBjb21wb25lbnQgd2lsbCBiZSBhZGRlZFxuICAgKiBAcGFyYW0ge0NvbXBvbmVudH0gQ29tcG9uZW50IENvbXBvbmVudCB0byBiZSBhZGRlZCB0byB0aGUgZW50aXR5XG4gICAqIEBwYXJhbSB7T2JqZWN0fSB2YWx1ZXMgT3B0aW9uYWwgdmFsdWVzIHRvIHJlcGxhY2UgdGhlIGRlZmF1bHQgYXR0cmlidXRlc1xuICAgKi9cbiAgZW50aXR5QWRkQ29tcG9uZW50KGVudGl0eSwgQ29tcG9uZW50LCB2YWx1ZXMpIHtcbiAgICBpZiAofmVudGl0eS5fQ29tcG9uZW50VHlwZXMuaW5kZXhPZihDb21wb25lbnQpKSByZXR1cm47XG5cbiAgICBlbnRpdHkuX0NvbXBvbmVudFR5cGVzLnB1c2goQ29tcG9uZW50KTtcblxuICAgIGlmIChDb21wb25lbnQuX19wcm90b19fID09PSBTeXN0ZW1TdGF0ZUNvbXBvbmVudCkge1xuICAgICAgdGhpcy5udW1TdGF0ZUNvbXBvbmVudHMrKztcbiAgICB9XG5cbiAgICB2YXIgY29tcG9uZW50UG9vbCA9IHRoaXMud29ybGQuY29tcG9uZW50c01hbmFnZXIuZ2V0Q29tcG9uZW50c1Bvb2woXG4gICAgICBDb21wb25lbnRcbiAgICApO1xuICAgIHZhciBjb21wb25lbnQgPSBjb21wb25lbnRQb29sLmFxdWlyZSgpO1xuXG4gICAgZW50aXR5Ll9jb21wb25lbnRzW0NvbXBvbmVudC5uYW1lXSA9IGNvbXBvbmVudDtcblxuICAgIGlmICh2YWx1ZXMpIHtcbiAgICAgIGlmIChjb21wb25lbnQuY29weSkge1xuICAgICAgICBjb21wb25lbnQuY29weSh2YWx1ZXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiB2YWx1ZXMpIHtcbiAgICAgICAgICBjb21wb25lbnRbbmFtZV0gPSB2YWx1ZXNbbmFtZV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLl9xdWVyeU1hbmFnZXIub25FbnRpdHlDb21wb25lbnRBZGRlZChlbnRpdHksIENvbXBvbmVudCk7XG4gICAgdGhpcy53b3JsZC5jb21wb25lbnRzTWFuYWdlci5jb21wb25lbnRBZGRlZFRvRW50aXR5KENvbXBvbmVudCk7XG5cbiAgICB0aGlzLmV2ZW50RGlzcGF0Y2hlci5kaXNwYXRjaEV2ZW50KENPTVBPTkVOVF9BRERFRCwgZW50aXR5LCBDb21wb25lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhIGNvbXBvbmVudCBmcm9tIGFuIGVudGl0eVxuICAgKiBAcGFyYW0ge0VudGl0eX0gZW50aXR5IEVudGl0eSB3aGljaCB3aWxsIGdldCByZW1vdmVkIHRoZSBjb21wb25lbnRcbiAgICogQHBhcmFtIHsqfSBDb21wb25lbnQgQ29tcG9uZW50IHRvIHJlbW92ZSBmcm9tIHRoZSBlbnRpdHlcbiAgICogQHBhcmFtIHtCb29sfSBpbW1lZGlhdGVseSBJZiB5b3Ugd2FudCB0byByZW1vdmUgdGhlIGNvbXBvbmVudCBpbW1lZGlhdGVseSBpbnN0ZWFkIG9mIGRlZmVycmVkIChEZWZhdWx0IGlzIGZhbHNlKVxuICAgKi9cbiAgZW50aXR5UmVtb3ZlQ29tcG9uZW50KGVudGl0eSwgQ29tcG9uZW50LCBpbW1lZGlhdGVseSkge1xuICAgIHZhciBpbmRleCA9IGVudGl0eS5fQ29tcG9uZW50VHlwZXMuaW5kZXhPZihDb21wb25lbnQpO1xuICAgIGlmICghfmluZGV4KSByZXR1cm47XG5cbiAgICB0aGlzLmV2ZW50RGlzcGF0Y2hlci5kaXNwYXRjaEV2ZW50KENPTVBPTkVOVF9SRU1PVkUsIGVudGl0eSwgQ29tcG9uZW50KTtcblxuICAgIGlmIChpbW1lZGlhdGVseSkge1xuICAgICAgdGhpcy5fZW50aXR5UmVtb3ZlQ29tcG9uZW50U3luYyhlbnRpdHksIENvbXBvbmVudCwgaW5kZXgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZW50aXR5Ll9Db21wb25lbnRUeXBlc1RvUmVtb3ZlLmxlbmd0aCA9PT0gMClcbiAgICAgICAgdGhpcy5lbnRpdGllc1dpdGhDb21wb25lbnRzVG9SZW1vdmUucHVzaChlbnRpdHkpO1xuXG4gICAgICBlbnRpdHkuX0NvbXBvbmVudFR5cGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICBlbnRpdHkuX0NvbXBvbmVudFR5cGVzVG9SZW1vdmUucHVzaChDb21wb25lbnQpO1xuXG4gICAgICB2YXIgY29tcG9uZW50TmFtZSA9IGdldE5hbWUoQ29tcG9uZW50KTtcbiAgICAgIGVudGl0eS5fY29tcG9uZW50c1RvUmVtb3ZlW2NvbXBvbmVudE5hbWVdID1cbiAgICAgICAgZW50aXR5Ll9jb21wb25lbnRzW2NvbXBvbmVudE5hbWVdO1xuICAgICAgZGVsZXRlIGVudGl0eS5fY29tcG9uZW50c1tjb21wb25lbnROYW1lXTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBlYWNoIGluZGV4ZWQgcXVlcnkgdG8gc2VlIGlmIHdlIG5lZWQgdG8gcmVtb3ZlIGl0XG4gICAgdGhpcy5fcXVlcnlNYW5hZ2VyLm9uRW50aXR5Q29tcG9uZW50UmVtb3ZlZChlbnRpdHksIENvbXBvbmVudCk7XG5cbiAgICBpZiAoQ29tcG9uZW50Ll9fcHJvdG9fXyA9PT0gU3lzdGVtU3RhdGVDb21wb25lbnQpIHtcbiAgICAgIHRoaXMubnVtU3RhdGVDb21wb25lbnRzLS07XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoZSBlbnRpdHkgd2FzIGEgZ2hvc3Qgd2FpdGluZyBmb3IgdGhlIGxhc3Qgc3lzdGVtIHN0YXRlIGNvbXBvbmVudCB0byBiZSByZW1vdmVkXG4gICAgICBpZiAodGhpcy5udW1TdGF0ZUNvbXBvbmVudHMgPT09IDAgJiYgIWVudGl0eS5hbGl2ZSkge1xuICAgICAgICBlbnRpdHkucmVtb3ZlKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgX2VudGl0eVJlbW92ZUNvbXBvbmVudFN5bmMoZW50aXR5LCBDb21wb25lbnQsIGluZGV4KSB7XG4gICAgLy8gUmVtb3ZlIFQgbGlzdGluZyBvbiBlbnRpdHkgYW5kIHByb3BlcnR5IHJlZiwgdGhlbiBmcmVlIHRoZSBjb21wb25lbnQuXG4gICAgZW50aXR5Ll9Db21wb25lbnRUeXBlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIHZhciBwcm9wTmFtZSA9IGNvbXBvbmVudFByb3BlcnR5TmFtZShDb21wb25lbnQpO1xuICAgIHZhciBjb21wb25lbnROYW1lID0gZ2V0TmFtZShDb21wb25lbnQpO1xuICAgIHZhciBjb21wb25lbnQgPSBlbnRpdHkuX2NvbXBvbmVudHNbY29tcG9uZW50TmFtZV07XG4gICAgZGVsZXRlIGVudGl0eS5fY29tcG9uZW50c1tjb21wb25lbnROYW1lXTtcbiAgICB0aGlzLmNvbXBvbmVudHNNYW5hZ2VyLl9jb21wb25lbnRQb29sW3Byb3BOYW1lXS5yZWxlYXNlKGNvbXBvbmVudCk7XG4gICAgdGhpcy53b3JsZC5jb21wb25lbnRzTWFuYWdlci5jb21wb25lbnRSZW1vdmVkRnJvbUVudGl0eShDb21wb25lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhbGwgdGhlIGNvbXBvbmVudHMgZnJvbSBhbiBlbnRpdHlcbiAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eSBFbnRpdHkgZnJvbSB3aGljaCB0aGUgY29tcG9uZW50cyB3aWxsIGJlIHJlbW92ZWRcbiAgICovXG4gIGVudGl0eVJlbW92ZUFsbENvbXBvbmVudHMoZW50aXR5LCBpbW1lZGlhdGVseSkge1xuICAgIGxldCBDb21wb25lbnRzID0gZW50aXR5Ll9Db21wb25lbnRUeXBlcztcblxuICAgIGZvciAobGV0IGogPSBDb21wb25lbnRzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG4gICAgICBpZiAoQ29tcG9uZW50c1tqXS5fX3Byb3RvX18gIT09IFN5c3RlbVN0YXRlQ29tcG9uZW50KVxuICAgICAgICB0aGlzLmVudGl0eVJlbW92ZUNvbXBvbmVudChlbnRpdHksIENvbXBvbmVudHNbal0sIGltbWVkaWF0ZWx5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSBlbnRpdHkgZnJvbSB0aGlzIG1hbmFnZXIuIEl0IHdpbGwgY2xlYXIgYWxzbyBpdHMgY29tcG9uZW50c1xuICAgKiBAcGFyYW0ge0VudGl0eX0gZW50aXR5IEVudGl0eSB0byByZW1vdmUgZnJvbSB0aGUgbWFuYWdlclxuICAgKiBAcGFyYW0ge0Jvb2x9IGltbWVkaWF0ZWx5IElmIHlvdSB3YW50IHRvIHJlbW92ZSB0aGUgY29tcG9uZW50IGltbWVkaWF0ZWx5IGluc3RlYWQgb2YgZGVmZXJyZWQgKERlZmF1bHQgaXMgZmFsc2UpXG4gICAqL1xuICByZW1vdmVFbnRpdHkoZW50aXR5LCBpbW1lZGlhdGVseSkge1xuICAgIHZhciBpbmRleCA9IHRoaXMuX2VudGl0aWVzLmluZGV4T2YoZW50aXR5KTtcblxuICAgIGlmICghfmluZGV4KSB0aHJvdyBuZXcgRXJyb3IoXCJUcmllZCB0byByZW1vdmUgZW50aXR5IG5vdCBpbiBsaXN0XCIpO1xuXG4gICAgZW50aXR5LmFsaXZlID0gZmFsc2U7XG5cbiAgICBpZiAodGhpcy5udW1TdGF0ZUNvbXBvbmVudHMgPT09IDApIHtcbiAgICAgIC8vIFJlbW92ZSBmcm9tIGVudGl0eSBsaXN0XG4gICAgICB0aGlzLmV2ZW50RGlzcGF0Y2hlci5kaXNwYXRjaEV2ZW50KEVOVElUWV9SRU1PVkVELCBlbnRpdHkpO1xuICAgICAgdGhpcy5fcXVlcnlNYW5hZ2VyLm9uRW50aXR5UmVtb3ZlZChlbnRpdHkpO1xuICAgICAgaWYgKGltbWVkaWF0ZWx5ID09PSB0cnVlKSB7XG4gICAgICAgIHRoaXMuX3JlbGVhc2VFbnRpdHkoZW50aXR5LCBpbmRleCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmVudGl0aWVzVG9SZW1vdmUucHVzaChlbnRpdHkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZW50aXR5UmVtb3ZlQWxsQ29tcG9uZW50cyhlbnRpdHksIGltbWVkaWF0ZWx5KTtcbiAgfVxuXG4gIF9yZWxlYXNlRW50aXR5KGVudGl0eSwgaW5kZXgpIHtcbiAgICB0aGlzLl9lbnRpdGllcy5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgLy8gUHJldmVudCBhbnkgYWNjZXNzIGFuZCBmcmVlXG4gICAgZW50aXR5Ll93b3JsZCA9IG51bGw7XG4gICAgdGhpcy5fZW50aXR5UG9vbC5yZWxlYXNlKGVudGl0eSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGFsbCBlbnRpdGllcyBmcm9tIHRoaXMgbWFuYWdlclxuICAgKi9cbiAgcmVtb3ZlQWxsRW50aXRpZXMoKSB7XG4gICAgZm9yICh2YXIgaSA9IHRoaXMuX2VudGl0aWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB0aGlzLnJlbW92ZUVudGl0eSh0aGlzLl9lbnRpdGllc1tpXSk7XG4gICAgfVxuICB9XG5cbiAgcHJvY2Vzc0RlZmVycmVkUmVtb3ZhbCgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZW50aXRpZXNUb1JlbW92ZS5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGVudGl0eSA9IHRoaXMuZW50aXRpZXNUb1JlbW92ZVtpXTtcbiAgICAgIGxldCBpbmRleCA9IHRoaXMuX2VudGl0aWVzLmluZGV4T2YoZW50aXR5KTtcbiAgICAgIHRoaXMuX3JlbGVhc2VFbnRpdHkoZW50aXR5LCBpbmRleCk7XG4gICAgfVxuICAgIHRoaXMuZW50aXRpZXNUb1JlbW92ZS5sZW5ndGggPSAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVudGl0aWVzV2l0aENvbXBvbmVudHNUb1JlbW92ZS5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGVudGl0eSA9IHRoaXMuZW50aXRpZXNXaXRoQ29tcG9uZW50c1RvUmVtb3ZlW2ldO1xuICAgICAgd2hpbGUgKGVudGl0eS5fQ29tcG9uZW50VHlwZXNUb1JlbW92ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGxldCBDb21wb25lbnQgPSBlbnRpdHkuX0NvbXBvbmVudFR5cGVzVG9SZW1vdmUucG9wKCk7XG5cbiAgICAgICAgdmFyIHByb3BOYW1lID0gY29tcG9uZW50UHJvcGVydHlOYW1lKENvbXBvbmVudCk7XG4gICAgICAgIHZhciBjb21wb25lbnROYW1lID0gZ2V0TmFtZShDb21wb25lbnQpO1xuICAgICAgICB2YXIgY29tcG9uZW50ID0gZW50aXR5Ll9jb21wb25lbnRzVG9SZW1vdmVbY29tcG9uZW50TmFtZV07XG4gICAgICAgIGRlbGV0ZSBlbnRpdHkuX2NvbXBvbmVudHNUb1JlbW92ZVtjb21wb25lbnROYW1lXTtcbiAgICAgICAgdGhpcy5jb21wb25lbnRzTWFuYWdlci5fY29tcG9uZW50UG9vbFtwcm9wTmFtZV0ucmVsZWFzZShjb21wb25lbnQpO1xuICAgICAgICB0aGlzLndvcmxkLmNvbXBvbmVudHNNYW5hZ2VyLmNvbXBvbmVudFJlbW92ZWRGcm9tRW50aXR5KENvbXBvbmVudCk7XG5cbiAgICAgICAgLy90aGlzLl9lbnRpdHlSZW1vdmVDb21wb25lbnRTeW5jKGVudGl0eSwgQ29tcG9uZW50LCBpbmRleCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5lbnRpdGllc1dpdGhDb21wb25lbnRzVG9SZW1vdmUubGVuZ3RoID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSBxdWVyeSBiYXNlZCBvbiBhIGxpc3Qgb2YgY29tcG9uZW50c1xuICAgKiBAcGFyYW0ge0FycmF5KENvbXBvbmVudCl9IENvbXBvbmVudHMgTGlzdCBvZiBjb21wb25lbnRzIHRoYXQgd2lsbCBmb3JtIHRoZSBxdWVyeVxuICAgKi9cbiAgcXVlcnlDb21wb25lbnRzKENvbXBvbmVudHMpIHtcbiAgICByZXR1cm4gdGhpcy5fcXVlcnlNYW5hZ2VyLmdldFF1ZXJ5KENvbXBvbmVudHMpO1xuICB9XG5cbiAgLy8gRVhUUkFTXG5cbiAgLyoqXG4gICAqIFJldHVybiBudW1iZXIgb2YgZW50aXRpZXNcbiAgICovXG4gIGNvdW50KCkge1xuICAgIHJldHVybiB0aGlzLl9lbnRpdGllcy5sZW5ndGg7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHNvbWUgc3RhdHNcbiAgICovXG4gIHN0YXRzKCkge1xuICAgIHZhciBzdGF0cyA9IHtcbiAgICAgIG51bUVudGl0aWVzOiB0aGlzLl9lbnRpdGllcy5sZW5ndGgsXG4gICAgICBudW1RdWVyaWVzOiBPYmplY3Qua2V5cyh0aGlzLl9xdWVyeU1hbmFnZXIuX3F1ZXJpZXMpLmxlbmd0aCxcbiAgICAgIHF1ZXJpZXM6IHRoaXMuX3F1ZXJ5TWFuYWdlci5zdGF0cygpLFxuICAgICAgbnVtQ29tcG9uZW50UG9vbDogT2JqZWN0LmtleXModGhpcy5jb21wb25lbnRzTWFuYWdlci5fY29tcG9uZW50UG9vbClcbiAgICAgICAgLmxlbmd0aCxcbiAgICAgIGNvbXBvbmVudFBvb2w6IHt9LFxuICAgICAgZXZlbnREaXNwYXRjaGVyOiB0aGlzLmV2ZW50RGlzcGF0Y2hlci5zdGF0c1xuICAgIH07XG5cbiAgICBmb3IgKHZhciBjbmFtZSBpbiB0aGlzLmNvbXBvbmVudHNNYW5hZ2VyLl9jb21wb25lbnRQb29sKSB7XG4gICAgICB2YXIgcG9vbCA9IHRoaXMuY29tcG9uZW50c01hbmFnZXIuX2NvbXBvbmVudFBvb2xbY25hbWVdO1xuICAgICAgc3RhdHMuY29tcG9uZW50UG9vbFtjbmFtZV0gPSB7XG4gICAgICAgIHVzZWQ6IHBvb2wudG90YWxVc2VkKCksXG4gICAgICAgIHNpemU6IHBvb2wuY291bnRcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YXRzO1xuICB9XG59XG5cbmNvbnN0IEVOVElUWV9DUkVBVEVEID0gXCJFbnRpdHlNYW5hZ2VyI0VOVElUWV9DUkVBVEVcIjtcbmNvbnN0IEVOVElUWV9SRU1PVkVEID0gXCJFbnRpdHlNYW5hZ2VyI0VOVElUWV9SRU1PVkVEXCI7XG5jb25zdCBDT01QT05FTlRfQURERUQgPSBcIkVudGl0eU1hbmFnZXIjQ09NUE9ORU5UX0FEREVEXCI7XG5jb25zdCBDT01QT05FTlRfUkVNT1ZFID0gXCJFbnRpdHlNYW5hZ2VyI0NPTVBPTkVOVF9SRU1PVkVcIjtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIER1bW15T2JqZWN0UG9vbCB7XG4gIGNvbnN0cnVjdG9yKFQpIHtcbiAgICB0aGlzLmlzRHVtbXlPYmplY3RQb29sID0gdHJ1ZTtcbiAgICB0aGlzLmNvdW50ID0gMDtcbiAgICB0aGlzLnVzZWQgPSAwO1xuICAgIHRoaXMuVCA9IFQ7XG4gIH1cblxuICBhcXVpcmUoKSB7XG4gICAgdGhpcy51c2VkKys7XG4gICAgdGhpcy5jb3VudCsrO1xuICAgIHJldHVybiBuZXcgdGhpcy5UKCk7XG4gIH1cblxuICByZWxlYXNlKCkge1xuICAgIHRoaXMudXNlZC0tO1xuICB9XG5cbiAgdG90YWxTaXplKCkge1xuICAgIHJldHVybiB0aGlzLmNvdW50O1xuICB9XG5cbiAgdG90YWxGcmVlKCkge1xuICAgIHJldHVybiBJbmZpbml0eTtcbiAgfVxuXG4gIHRvdGFsVXNlZCgpIHtcbiAgICByZXR1cm4gdGhpcy51c2VkO1xuICB9XG59XG4iLCJpbXBvcnQgT2JqZWN0UG9vbCBmcm9tIFwiLi9PYmplY3RQb29sLmpzXCI7XG5pbXBvcnQgRHVtbXlPYmplY3RQb29sIGZyb20gXCIuL0R1bW15T2JqZWN0UG9vbC5qc1wiO1xuaW1wb3J0IHsgY29tcG9uZW50UHJvcGVydHlOYW1lIH0gZnJvbSBcIi4vVXRpbHMuanNcIjtcblxuZXhwb3J0IGNsYXNzIENvbXBvbmVudE1hbmFnZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLkNvbXBvbmVudHMgPSB7fTtcbiAgICB0aGlzLl9jb21wb25lbnRQb29sID0ge307XG4gICAgdGhpcy5udW1Db21wb25lbnRzID0ge307XG4gIH1cblxuICByZWdpc3RlckNvbXBvbmVudChDb21wb25lbnQpIHtcbiAgICB0aGlzLkNvbXBvbmVudHNbQ29tcG9uZW50Lm5hbWVdID0gQ29tcG9uZW50O1xuICAgIHRoaXMubnVtQ29tcG9uZW50c1tDb21wb25lbnQubmFtZV0gPSAwO1xuICB9XG5cbiAgY29tcG9uZW50QWRkZWRUb0VudGl0eShDb21wb25lbnQpIHtcbiAgICBpZiAoIXRoaXMubnVtQ29tcG9uZW50c1tDb21wb25lbnQubmFtZV0pIHtcbiAgICAgIHRoaXMubnVtQ29tcG9uZW50c1tDb21wb25lbnQubmFtZV0gPSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm51bUNvbXBvbmVudHNbQ29tcG9uZW50Lm5hbWVdKys7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50UmVtb3ZlZEZyb21FbnRpdHkoQ29tcG9uZW50KSB7XG4gICAgdGhpcy5udW1Db21wb25lbnRzW0NvbXBvbmVudC5uYW1lXS0tO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50c1Bvb2woQ29tcG9uZW50KSB7XG4gICAgdmFyIGNvbXBvbmVudE5hbWUgPSBjb21wb25lbnRQcm9wZXJ0eU5hbWUoQ29tcG9uZW50KTtcblxuICAgIGlmICghdGhpcy5fY29tcG9uZW50UG9vbFtjb21wb25lbnROYW1lXSkge1xuICAgICAgaWYgKENvbXBvbmVudC5wcm90b3R5cGUucmVzZXQpIHtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50UG9vbFtjb21wb25lbnROYW1lXSA9IG5ldyBPYmplY3RQb29sKENvbXBvbmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgYENvbXBvbmVudCAnJHtDb21wb25lbnQubmFtZX0nIHdvbid0IGJlbmVmaXQgZnJvbSBwb29saW5nIGJlY2F1c2UgJ3Jlc2V0JyBtZXRob2Qgd2FzIG5vdCBpbXBsZW1lbmV0ZWQuYFxuICAgICAgICApO1xuICAgICAgICB0aGlzLl9jb21wb25lbnRQb29sW2NvbXBvbmVudE5hbWVdID0gbmV3IER1bW15T2JqZWN0UG9vbChDb21wb25lbnQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRQb29sW2NvbXBvbmVudE5hbWVdO1xuICB9XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gY3JlYXRlVHlwZSh0eXBlRGVmaW5pdGlvbikge1xuICB2YXIgbWFuZGF0b3J5RnVuY3Rpb25zID0gW1xuICAgIFwiY3JlYXRlXCIsXG4gICAgXCJyZXNldFwiLFxuICAgIFwiY2xlYXJcIlxuICAgIC8qXCJjb3B5XCIqL1xuICBdO1xuXG4gIHZhciB1bmRlZmluZWRGdW5jdGlvbnMgPSBtYW5kYXRvcnlGdW5jdGlvbnMuZmlsdGVyKGYgPT4ge1xuICAgIHJldHVybiAhdHlwZURlZmluaXRpb25bZl07XG4gIH0pO1xuXG4gIGlmICh1bmRlZmluZWRGdW5jdGlvbnMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBjcmVhdGVUeXBlIGV4cGVjdCB0eXBlIGRlZmluaXRpb24gdG8gaW1wbGVtZW50cyB0aGUgZm9sbG93aW5nIGZ1bmN0aW9uczogJHt1bmRlZmluZWRGdW5jdGlvbnMuam9pbihcbiAgICAgICAgXCIsIFwiXG4gICAgICApfWBcbiAgICApO1xuICB9XG5cbiAgdHlwZURlZmluaXRpb24uaXNUeXBlID0gdHJ1ZTtcbiAgcmV0dXJuIHR5cGVEZWZpbml0aW9uO1xufVxuIiwiaW1wb3J0IHsgY3JlYXRlVHlwZSB9IGZyb20gXCIuL0NyZWF0ZVR5cGVcIjtcblxuLyoqXG4gKiBTdGFuZGFyZCB0eXBlc1xuICovXG52YXIgVHlwZXMgPSB7fTtcblxuVHlwZXMuTnVtYmVyID0gY3JlYXRlVHlwZSh7XG4gIGJhc2VUeXBlOiBOdW1iZXIsXG4gIGlzU2ltcGxlVHlwZTogdHJ1ZSxcbiAgY3JlYXRlOiBkZWZhdWx0VmFsdWUgPT4ge1xuICAgIHJldHVybiB0eXBlb2YgZGVmYXVsdFZhbHVlICE9PSBcInVuZGVmaW5lZFwiID8gZGVmYXVsdFZhbHVlIDogMDtcbiAgfSxcbiAgcmVzZXQ6IChzcmMsIGtleSwgZGVmYXVsdFZhbHVlKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBkZWZhdWx0VmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHNyY1trZXldID0gZGVmYXVsdFZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcmNba2V5XSA9IDA7XG4gICAgfVxuICB9LFxuICBjbGVhcjogKHNyYywga2V5KSA9PiB7XG4gICAgc3JjW2tleV0gPSAwO1xuICB9XG59KTtcblxuVHlwZXMuQm9vbGVhbiA9IGNyZWF0ZVR5cGUoe1xuICBiYXNlVHlwZTogQm9vbGVhbixcbiAgaXNTaW1wbGVUeXBlOiB0cnVlLFxuICBjcmVhdGU6IGRlZmF1bHRWYWx1ZSA9PiB7XG4gICAgcmV0dXJuIHR5cGVvZiBkZWZhdWx0VmFsdWUgIT09IFwidW5kZWZpbmVkXCIgPyBkZWZhdWx0VmFsdWUgOiBmYWxzZTtcbiAgfSxcbiAgcmVzZXQ6IChzcmMsIGtleSwgZGVmYXVsdFZhbHVlKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBkZWZhdWx0VmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHNyY1trZXldID0gZGVmYXVsdFZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcmNba2V5XSA9IGZhbHNlO1xuICAgIH1cbiAgfSxcbiAgY2xlYXI6IChzcmMsIGtleSkgPT4ge1xuICAgIHNyY1trZXldID0gZmFsc2U7XG4gIH1cbn0pO1xuXG5UeXBlcy5TdHJpbmcgPSBjcmVhdGVUeXBlKHtcbiAgYmFzZVR5cGU6IFN0cmluZyxcbiAgaXNTaW1wbGVUeXBlOiB0cnVlLFxuICBjcmVhdGU6IGRlZmF1bHRWYWx1ZSA9PiB7XG4gICAgcmV0dXJuIHR5cGVvZiBkZWZhdWx0VmFsdWUgIT09IFwidW5kZWZpbmVkXCIgPyBkZWZhdWx0VmFsdWUgOiBcIlwiO1xuICB9LFxuICByZXNldDogKHNyYywga2V5LCBkZWZhdWx0VmFsdWUpID0+IHtcbiAgICBpZiAodHlwZW9mIGRlZmF1bHRWYWx1ZSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgc3JjW2tleV0gPSBkZWZhdWx0VmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNyY1trZXldID0gXCJcIjtcbiAgICB9XG4gIH0sXG4gIGNsZWFyOiAoc3JjLCBrZXkpID0+IHtcbiAgICBzcmNba2V5XSA9IFwiXCI7XG4gIH1cbn0pO1xuXG5UeXBlcy5BcnJheSA9IGNyZWF0ZVR5cGUoe1xuICBiYXNlVHlwZTogQXJyYXksXG4gIGNyZWF0ZTogZGVmYXVsdFZhbHVlID0+IHtcbiAgICBpZiAodHlwZW9mIGRlZmF1bHRWYWx1ZSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZS5zbGljZSgpO1xuICAgIH1cblxuICAgIHJldHVybiBbXTtcbiAgfSxcbiAgcmVzZXQ6IChzcmMsIGtleSwgZGVmYXVsdFZhbHVlKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBkZWZhdWx0VmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHNyY1trZXldID0gZGVmYXVsdFZhbHVlLnNsaWNlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNyY1trZXldLmxlbmd0aCA9IDA7XG4gICAgfVxuICB9LFxuICBjbGVhcjogKHNyYywga2V5KSA9PiB7XG4gICAgc3JjW2tleV0ubGVuZ3RoID0gMDtcbiAgfSxcbiAgY29weTogKHNyYywgZHN0LCBrZXkpID0+IHtcbiAgICBzcmNba2V5XSA9IGRzdFtrZXldLnNsaWNlKCk7XG4gIH1cbn0pO1xuXG5leHBvcnQgeyBUeXBlcyB9O1xuIiwiaW1wb3J0IHsgVHlwZXMgfSBmcm9tIFwiLi9TdGFuZGFyZFR5cGVzXCI7XG5cbnZhciBzdGFuZGFyZFR5cGVzID0ge1xuICBudW1iZXI6IFR5cGVzLk51bWJlcixcbiAgYm9vbGVhbjogVHlwZXMuQm9vbGVhbixcbiAgc3RyaW5nOiBUeXBlcy5TdHJpbmdcbn07XG5cbi8qKlxuICogVHJ5IHRvIGluZmVyIHRoZSB0eXBlIG9mIHRoZSB2YWx1ZVxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7U3RyaW5nfSBUeXBlIG9mIHRoZSBhdHRyaWJ1dGVcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbmZlclR5cGUodmFsdWUpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgcmV0dXJuIFR5cGVzLkFycmF5O1xuICB9XG5cbiAgaWYgKHN0YW5kYXJkVHlwZXNbdHlwZW9mIHZhbHVlXSkge1xuICAgIHJldHVybiBzdGFuZGFyZFR5cGVzW3R5cGVvZiB2YWx1ZV07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBDb21wb25lbnQge31cbiIsImltcG9ydCBRdWVyeSBmcm9tIFwiLi9RdWVyeS5qc1wiO1xuXG5leHBvcnQgY2xhc3MgU3lzdGVtIHtcbiAgY2FuRXhlY3V0ZSgpIHtcbiAgICBpZiAodGhpcy5fbWFuZGF0b3J5UXVlcmllcy5sZW5ndGggPT09IDApIHJldHVybiB0cnVlO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9tYW5kYXRvcnlRdWVyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgcXVlcnkgPSB0aGlzLl9tYW5kYXRvcnlRdWVyaWVzW2ldO1xuICAgICAgaWYgKHF1ZXJ5LmVudGl0aWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcih3b3JsZCwgYXR0cmlidXRlcykge1xuICAgIHRoaXMud29ybGQgPSB3b3JsZDtcbiAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuXG4gICAgLy8gQHRvZG8gQmV0dGVyIG5hbWluZyA6KVxuICAgIHRoaXMuX3F1ZXJpZXMgPSB7fTtcbiAgICB0aGlzLnF1ZXJpZXMgPSB7fTtcblxuICAgIHRoaXMucHJpb3JpdHkgPSAwO1xuXG4gICAgLy8gVXNlZCBmb3Igc3RhdHNcbiAgICB0aGlzLmV4ZWN1dGVUaW1lID0gMDtcblxuICAgIGlmIChhdHRyaWJ1dGVzICYmIGF0dHJpYnV0ZXMucHJpb3JpdHkpIHtcbiAgICAgIHRoaXMucHJpb3JpdHkgPSBhdHRyaWJ1dGVzLnByaW9yaXR5O1xuICAgIH1cblxuICAgIHRoaXMuX21hbmRhdG9yeVF1ZXJpZXMgPSBbXTtcblxuICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXG4gICAgaWYgKHRoaXMuY29uc3RydWN0b3IucXVlcmllcykge1xuICAgICAgZm9yICh2YXIgcXVlcnlOYW1lIGluIHRoaXMuY29uc3RydWN0b3IucXVlcmllcykge1xuICAgICAgICB2YXIgcXVlcnlDb25maWcgPSB0aGlzLmNvbnN0cnVjdG9yLnF1ZXJpZXNbcXVlcnlOYW1lXTtcbiAgICAgICAgdmFyIENvbXBvbmVudHMgPSBxdWVyeUNvbmZpZy5jb21wb25lbnRzO1xuICAgICAgICBpZiAoIUNvbXBvbmVudHMgfHwgQ29tcG9uZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCInY29tcG9uZW50cycgYXR0cmlidXRlIGNhbid0IGJlIGVtcHR5IGluIGEgcXVlcnlcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy53b3JsZC5lbnRpdHlNYW5hZ2VyLnF1ZXJ5Q29tcG9uZW50cyhDb21wb25lbnRzKTtcbiAgICAgICAgdGhpcy5fcXVlcmllc1txdWVyeU5hbWVdID0gcXVlcnk7XG4gICAgICAgIGlmIChxdWVyeUNvbmZpZy5tYW5kYXRvcnkgPT09IHRydWUpIHtcbiAgICAgICAgICB0aGlzLl9tYW5kYXRvcnlRdWVyaWVzLnB1c2gocXVlcnkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucXVlcmllc1txdWVyeU5hbWVdID0ge1xuICAgICAgICAgIHJlc3VsdHM6IHF1ZXJ5LmVudGl0aWVzXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gUmVhY3RpdmUgY29uZmlndXJhdGlvbiBhZGRlZC9yZW1vdmVkL2NoYW5nZWRcbiAgICAgICAgdmFyIHZhbGlkRXZlbnRzID0gW1wiYWRkZWRcIiwgXCJyZW1vdmVkXCIsIFwiY2hhbmdlZFwiXTtcblxuICAgICAgICBjb25zdCBldmVudE1hcHBpbmcgPSB7XG4gICAgICAgICAgYWRkZWQ6IFF1ZXJ5LnByb3RvdHlwZS5FTlRJVFlfQURERUQsXG4gICAgICAgICAgcmVtb3ZlZDogUXVlcnkucHJvdG90eXBlLkVOVElUWV9SRU1PVkVELFxuICAgICAgICAgIGNoYW5nZWQ6IFF1ZXJ5LnByb3RvdHlwZS5DT01QT05FTlRfQ0hBTkdFRCAvLyBRdWVyeS5wcm90b3R5cGUuRU5USVRZX0NIQU5HRURcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAocXVlcnlDb25maWcubGlzdGVuKSB7XG4gICAgICAgICAgdmFsaWRFdmVudHMuZm9yRWFjaChldmVudE5hbWUgPT4ge1xuICAgICAgICAgICAgLy8gSXMgdGhlIGV2ZW50IGVuYWJsZWQgb24gdGhpcyBzeXN0ZW0ncyBxdWVyeT9cbiAgICAgICAgICAgIGlmIChxdWVyeUNvbmZpZy5saXN0ZW5bZXZlbnROYW1lXSkge1xuICAgICAgICAgICAgICBsZXQgZXZlbnQgPSBxdWVyeUNvbmZpZy5saXN0ZW5bZXZlbnROYW1lXTtcblxuICAgICAgICAgICAgICBpZiAoZXZlbnROYW1lID09PSBcImNoYW5nZWRcIikge1xuICAgICAgICAgICAgICAgIHF1ZXJ5LnJlYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgIC8vIEFueSBjaGFuZ2Ugb24gdGhlIGVudGl0eSBmcm9tIHRoZSBjb21wb25lbnRzIGluIHRoZSBxdWVyeVxuICAgICAgICAgICAgICAgICAgbGV0IGV2ZW50TGlzdCA9ICh0aGlzLnF1ZXJpZXNbcXVlcnlOYW1lXVtldmVudE5hbWVdID0gW10pO1xuICAgICAgICAgICAgICAgICAgcXVlcnkuZXZlbnREaXNwYXRjaGVyLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgICAgIFF1ZXJ5LnByb3RvdHlwZS5DT01QT05FTlRfQ0hBTkdFRCxcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBBdm9pZCBkdXBsaWNhdGVzXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50TGlzdC5pbmRleE9mKGVudGl0eSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudExpc3QucHVzaChlbnRpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoZXZlbnQpKSB7XG4gICAgICAgICAgICAgICAgICBsZXQgZXZlbnRMaXN0ID0gKHRoaXMucXVlcmllc1txdWVyeU5hbWVdW2V2ZW50TmFtZV0gPSBbXSk7XG4gICAgICAgICAgICAgICAgICBxdWVyeS5ldmVudERpc3BhdGNoZXIuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICAgICAgICAgUXVlcnkucHJvdG90eXBlLkNPTVBPTkVOVF9DSEFOR0VELFxuICAgICAgICAgICAgICAgICAgICAoZW50aXR5LCBjaGFuZ2VkQ29tcG9uZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gQXZvaWQgZHVwbGljYXRlc1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LmluZGV4T2YoY2hhbmdlZENvbXBvbmVudC5jb25zdHJ1Y3RvcikgIT09IC0xICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudExpc3QuaW5kZXhPZihlbnRpdHkpID09PSAtMVxuICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRMaXN0LnB1c2goZW50aXR5KTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAvLyBDaGVja2luZyBqdXN0IHNwZWNpZmljIGNvbXBvbmVudHNcbiAgICAgICAgICAgICAgICAgIGxldCBjaGFuZ2VkTGlzdCA9ICh0aGlzLnF1ZXJpZXNbcXVlcnlOYW1lXVtldmVudE5hbWVdID0ge30pO1xuICAgICAgICAgICAgICAgICAgZXZlbnQuZm9yRWFjaChjb21wb25lbnQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZXZlbnRMaXN0ID0gKGNoYW5nZWRMaXN0W1xuICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudFByb3BlcnR5TmFtZShjb21wb25lbnQpXG4gICAgICAgICAgICAgICAgICAgIF0gPSBbXSk7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5LmV2ZW50RGlzcGF0Y2hlci5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgICAgICAgICAgICAgIFF1ZXJ5LnByb3RvdHlwZS5DT01QT05FTlRfQ0hBTkdFRCxcbiAgICAgICAgICAgICAgICAgICAgICAoZW50aXR5LCBjaGFuZ2VkQ29tcG9uZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZWRDb21wb25lbnQuY29uc3RydWN0b3IgPT09IGNvbXBvbmVudCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudExpc3QuaW5kZXhPZihlbnRpdHkpID09PSAtMVxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50TGlzdC5wdXNoKGVudGl0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZXQgZXZlbnRMaXN0ID0gKHRoaXMucXVlcmllc1txdWVyeU5hbWVdW2V2ZW50TmFtZV0gPSBbXSk7XG5cbiAgICAgICAgICAgICAgICBxdWVyeS5ldmVudERpc3BhdGNoZXIuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICAgICAgIGV2ZW50TWFwcGluZ1tldmVudE5hbWVdLFxuICAgICAgICAgICAgICAgICAgZW50aXR5ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQGZpeG1lIG92ZXJoZWFkP1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnRMaXN0LmluZGV4T2YoZW50aXR5KSA9PT0gLTEpXG4gICAgICAgICAgICAgICAgICAgICAgZXZlbnRMaXN0LnB1c2goZW50aXR5KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIHRoaXMuZXhlY3V0ZVRpbWUgPSAwO1xuICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgcGxheSgpIHtcbiAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgLy8gQHF1ZXN0aW9uIHJlbmFtZSB0byBjbGVhciBxdWV1ZXM/XG4gIGNsZWFyRXZlbnRzKCkge1xuICAgIGZvciAobGV0IHF1ZXJ5TmFtZSBpbiB0aGlzLnF1ZXJpZXMpIHtcbiAgICAgIHZhciBxdWVyeSA9IHRoaXMucXVlcmllc1txdWVyeU5hbWVdO1xuICAgICAgaWYgKHF1ZXJ5LmFkZGVkKSBxdWVyeS5hZGRlZC5sZW5ndGggPSAwO1xuICAgICAgaWYgKHF1ZXJ5LnJlbW92ZWQpIHF1ZXJ5LnJlbW92ZWQubGVuZ3RoID0gMDtcbiAgICAgIGlmIChxdWVyeS5jaGFuZ2VkKSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHF1ZXJ5LmNoYW5nZWQpKSB7XG4gICAgICAgICAgcXVlcnkuY2hhbmdlZC5sZW5ndGggPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAobGV0IG5hbWUgaW4gcXVlcnkuY2hhbmdlZCkge1xuICAgICAgICAgICAgcXVlcnkuY2hhbmdlZFtuYW1lXS5sZW5ndGggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHRvSlNPTigpIHtcbiAgICB2YXIganNvbiA9IHtcbiAgICAgIG5hbWU6IHRoaXMuY29uc3RydWN0b3IubmFtZSxcbiAgICAgIGVuYWJsZWQ6IHRoaXMuZW5hYmxlZCxcbiAgICAgIGV4ZWN1dGVUaW1lOiB0aGlzLmV4ZWN1dGVUaW1lLFxuICAgICAgcHJpb3JpdHk6IHRoaXMucHJpb3JpdHksXG4gICAgICBxdWVyaWVzOiB7fVxuICAgIH07XG5cbiAgICBpZiAodGhpcy5jb25zdHJ1Y3Rvci5xdWVyaWVzKSB7XG4gICAgICB2YXIgcXVlcmllcyA9IHRoaXMuY29uc3RydWN0b3IucXVlcmllcztcbiAgICAgIGZvciAobGV0IHF1ZXJ5TmFtZSBpbiBxdWVyaWVzKSB7XG4gICAgICAgIGxldCBxdWVyeSA9IHF1ZXJpZXNbcXVlcnlOYW1lXTtcbiAgICAgICAganNvbi5xdWVyaWVzW3F1ZXJ5TmFtZV0gPSB7XG4gICAgICAgICAga2V5OiB0aGlzLl9xdWVyaWVzW3F1ZXJ5TmFtZV0ua2V5XG4gICAgICAgIH07XG5cbiAgICAgICAganNvbi5xdWVyaWVzW3F1ZXJ5TmFtZV0ubWFuZGF0b3J5ID0gcXVlcnkubWFuZGF0b3J5ID09PSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBqc29uO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBOb3QoQ29tcG9uZW50KSB7XG4gIHJldHVybiB7XG4gICAgb3BlcmF0b3I6IFwibm90XCIsXG4gICAgQ29tcG9uZW50OiBDb21wb25lbnRcbiAgfTtcbn1cbiIsImV4cG9ydCBjbGFzcyBUYWdDb21wb25lbnQge1xuICByZXNldCgpIHt9XG59XG4iLCJpbXBvcnQgeyBTeXN0ZW1NYW5hZ2VyIH0gZnJvbSBcIi4vU3lzdGVtTWFuYWdlci5qc1wiO1xuaW1wb3J0IHsgRW50aXR5TWFuYWdlciB9IGZyb20gXCIuL0VudGl0eU1hbmFnZXIuanNcIjtcbmltcG9ydCB7IENvbXBvbmVudE1hbmFnZXIgfSBmcm9tIFwiLi9Db21wb25lbnRNYW5hZ2VyLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBXb3JsZCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY29tcG9uZW50c01hbmFnZXIgPSBuZXcgQ29tcG9uZW50TWFuYWdlcih0aGlzKTtcbiAgICB0aGlzLmVudGl0eU1hbmFnZXIgPSBuZXcgRW50aXR5TWFuYWdlcih0aGlzKTtcbiAgICB0aGlzLnN5c3RlbU1hbmFnZXIgPSBuZXcgU3lzdGVtTWFuYWdlcih0aGlzKTtcblxuICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XG5cbiAgICB0aGlzLmV2ZW50UXVldWVzID0ge307XG5cbiAgICBpZiAodHlwZW9mIEN1c3RvbUV2ZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICB2YXIgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoXCJlY3N5LXdvcmxkLWNyZWF0ZWRcIiwgeyBkZXRhaWw6IHRoaXMgfSk7XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJDb21wb25lbnQoQ29tcG9uZW50KSB7XG4gICAgdGhpcy5jb21wb25lbnRzTWFuYWdlci5yZWdpc3RlckNvbXBvbmVudChDb21wb25lbnQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcmVnaXN0ZXJTeXN0ZW0oU3lzdGVtLCBhdHRyaWJ1dGVzKSB7XG4gICAgdGhpcy5zeXN0ZW1NYW5hZ2VyLnJlZ2lzdGVyU3lzdGVtKFN5c3RlbSwgYXR0cmlidXRlcyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBnZXRTeXN0ZW0oU3lzdGVtQ2xhc3MpIHtcbiAgICByZXR1cm4gdGhpcy5zeXN0ZW1NYW5hZ2VyLmdldFN5c3RlbShTeXN0ZW1DbGFzcyk7XG4gIH1cblxuICBnZXRTeXN0ZW1zKCkge1xuICAgIHJldHVybiB0aGlzLnN5c3RlbU1hbmFnZXIuZ2V0U3lzdGVtcygpO1xuICB9XG5cbiAgZXhlY3V0ZShkZWx0YSwgdGltZSkge1xuICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc3lzdGVtTWFuYWdlci5leGVjdXRlKGRlbHRhLCB0aW1lKTtcbiAgICAgIHRoaXMuZW50aXR5TWFuYWdlci5wcm9jZXNzRGVmZXJyZWRSZW1vdmFsKCk7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHBsYXkoKSB7XG4gICAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIGNyZWF0ZUVudGl0eSgpIHtcbiAgICByZXR1cm4gdGhpcy5lbnRpdHlNYW5hZ2VyLmNyZWF0ZUVudGl0eSgpO1xuICB9XG5cbiAgc3RhdHMoKSB7XG4gICAgdmFyIHN0YXRzID0ge1xuICAgICAgZW50aXRpZXM6IHRoaXMuZW50aXR5TWFuYWdlci5zdGF0cygpLFxuICAgICAgc3lzdGVtOiB0aGlzLnN5c3RlbU1hbmFnZXIuc3RhdHMoKVxuICAgIH07XG5cbiAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShzdGF0cywgbnVsbCwgMikpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBpbmZlclR5cGUgfSBmcm9tIFwiLi9JbmZlclR5cGVcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNvbXBvbmVudENsYXNzKHNjaGVtYSwgbmFtZSkge1xuICAvL3ZhciBDb21wb25lbnQgPSBuZXcgRnVuY3Rpb24oYHJldHVybiBmdW5jdGlvbiAke25hbWV9KCkge31gKSgpO1xuICBmb3IgKGxldCBrZXkgaW4gc2NoZW1hKSB7XG4gICAgbGV0IHR5cGUgPSBzY2hlbWFba2V5XS50eXBlO1xuICAgIGlmICghdHlwZSkge1xuICAgICAgc2NoZW1hW2tleV0udHlwZSA9IGluZmVyVHlwZShzY2hlbWFba2V5XS5kZWZhdWx0KTtcbiAgICB9XG4gIH1cblxuICB2YXIgQ29tcG9uZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgZm9yIChsZXQga2V5IGluIHNjaGVtYSkge1xuICAgICAgdmFyIGF0dHIgPSBzY2hlbWFba2V5XTtcbiAgICAgIGxldCB0eXBlID0gYXR0ci50eXBlO1xuICAgICAgaWYgKHR5cGUgJiYgdHlwZS5pc1R5cGUpIHtcbiAgICAgICAgdGhpc1trZXldID0gdHlwZS5jcmVhdGUoYXR0ci5kZWZhdWx0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXNba2V5XSA9IGF0dHIuZGVmYXVsdDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgaWYgKHR5cGVvZiBuYW1lICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbXBvbmVudCwgXCJuYW1lXCIsIHsgdmFsdWU6IG5hbWUgfSk7XG4gIH1cblxuICBDb21wb25lbnQucHJvdG90eXBlLnNjaGVtYSA9IHNjaGVtYTtcblxuICB2YXIga25vd25UeXBlcyA9IHRydWU7XG4gIGZvciAobGV0IGtleSBpbiBzY2hlbWEpIHtcbiAgICB2YXIgYXR0ciA9IHNjaGVtYVtrZXldO1xuICAgIGlmICghYXR0ci50eXBlKSB7XG4gICAgICBhdHRyLnR5cGUgPSBpbmZlclR5cGUoYXR0ci5kZWZhdWx0KTtcbiAgICB9XG5cbiAgICB2YXIgdHlwZSA9IGF0dHIudHlwZTtcbiAgICBpZiAoIXR5cGUpIHtcbiAgICAgIGNvbnNvbGUud2FybihgVW5rbm93biB0eXBlIGRlZmluaXRpb24gZm9yIGF0dHJpYnV0ZSAnJHtrZXl9J2ApO1xuICAgICAga25vd25UeXBlcyA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGlmICgha25vd25UeXBlcykge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIGBUaGlzIGNvbXBvbmVudCBjYW4ndCB1c2UgcG9vbGluZyBiZWNhdXNlIHNvbWUgZGF0YSB0eXBlcyBhcmUgbm90IHJlZ2lzdGVyZWQuIFBsZWFzZSBwcm92aWRlIGEgdHlwZSBjcmVhdGVkIHdpdGggJ2NyZWF0ZVR5cGUnYFxuICAgICk7XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gc2NoZW1hKSB7XG4gICAgICBsZXQgYXR0ciA9IHNjaGVtYVtrZXldO1xuICAgICAgQ29tcG9uZW50LnByb3RvdHlwZVtrZXldID0gYXR0ci5kZWZhdWx0O1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBDb21wb25lbnQucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbihzcmMpIHtcbiAgICAgIGZvciAobGV0IGtleSBpbiBzY2hlbWEpIHtcbiAgICAgICAgaWYgKHNyY1trZXldKSB7XG4gICAgICAgICAgbGV0IHR5cGUgPSBzY2hlbWFba2V5XS50eXBlO1xuICAgICAgICAgIGlmICh0eXBlLmlzU2ltcGxlVHlwZSkge1xuICAgICAgICAgICAgdGhpc1trZXldID0gc3JjW2tleV07XG4gICAgICAgICAgfSBlbHNlIGlmICh0eXBlLmNvcHkpIHtcbiAgICAgICAgICAgIHR5cGUuY29weSh0aGlzLCBzcmMsIGtleSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEB0b2RvIERldGVjdCB0aGF0IGl0J3Mgbm90IHBvc3NpYmxlIHRvIGNvcHkgYWxsIHRoZSBhdHRyaWJ1dGVzXG4gICAgICAgICAgICAvLyBhbmQganVzdCBhdm9pZCBjcmVhdGluZyB0aGUgY29weSBmdW5jdGlvblxuICAgICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgICBgVW5rbm93biBjb3B5IGZ1bmN0aW9uIGZvciBhdHRyaWJ1dGUgJyR7a2V5fScgZGF0YSB0eXBlYFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgZm9yIChsZXQga2V5IGluIHNjaGVtYSkge1xuICAgICAgICBsZXQgYXR0ciA9IHNjaGVtYVtrZXldO1xuICAgICAgICBsZXQgdHlwZSA9IGF0dHIudHlwZTtcbiAgICAgICAgaWYgKHR5cGUucmVzZXQpIHR5cGUucmVzZXQodGhpcywga2V5LCBhdHRyLmRlZmF1bHQpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBDb21wb25lbnQucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgICBmb3IgKGxldCBrZXkgaW4gc2NoZW1hKSB7XG4gICAgICAgIGxldCB0eXBlID0gc2NoZW1hW2tleV0udHlwZTtcbiAgICAgICAgaWYgKHR5cGUuY2xlYXIpIHR5cGUuY2xlYXIodGhpcywga2V5KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZm9yIChsZXQga2V5IGluIHNjaGVtYSkge1xuICAgICAgbGV0IGF0dHIgPSBzY2hlbWFba2V5XTtcbiAgICAgIGxldCB0eXBlID0gYXR0ci50eXBlO1xuICAgICAgQ29tcG9uZW50LnByb3RvdHlwZVtrZXldID0gYXR0ci5kZWZhdWx0O1xuXG4gICAgICBpZiAodHlwZS5yZXNldCkge1xuICAgICAgICB0eXBlLnJlc2V0KENvbXBvbmVudC5wcm90b3R5cGUsIGtleSwgYXR0ci5kZWZhdWx0KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gQ29tcG9uZW50O1xufVxuIl0sIm5hbWVzIjpbIlN5c3RlbU1hbmFnZXIiLCJbb2JqZWN0IE9iamVjdF0iLCJ3b3JsZCIsInRoaXMiLCJfc3lzdGVtcyIsIl9leGVjdXRlU3lzdGVtcyIsImxhc3RFeGVjdXRlZFN5c3RlbSIsIlN5c3RlbSIsImF0dHJpYnV0ZXMiLCJzeXN0ZW0iLCJpbml0Iiwib3JkZXIiLCJsZW5ndGgiLCJwdXNoIiwiZXhlY3V0ZSIsInNvcnRTeXN0ZW1zIiwic29ydCIsImEiLCJiIiwicHJpb3JpdHkiLCJmaW5kIiwicyIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsImRlbHRhIiwidGltZSIsImluaXRpYWxpemVkIiwiY2FuRXhlY3V0ZSIsInN0YXJ0VGltZSIsInBlcmZvcm1hbmNlIiwibm93IiwiZXhlY3V0ZVRpbWUiLCJjbGVhckV2ZW50cyIsImZvcmNlUGxheSIsImZvckVhY2giLCJlbmFibGVkIiwiZXhlY3V0ZVN5c3RlbSIsInN0YXRzIiwibnVtU3lzdGVtcyIsInN5c3RlbXMiLCJpIiwic3lzdGVtU3RhdHMiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJxdWVyaWVzIiwiY3R4IiwiRXZlbnREaXNwYXRjaGVyIiwiX2xpc3RlbmVycyIsImZpcmVkIiwiaGFuZGxlZCIsImV2ZW50TmFtZSIsImxpc3RlbmVyIiwibGlzdGVuZXJzIiwidW5kZWZpbmVkIiwibGlzdGVuZXJBcnJheSIsImVudGl0eSIsImNvbXBvbmVudCIsImFycmF5Iiwic2xpY2UiLCJjYWxsIiwiZ2V0TmFtZSIsIkNvbXBvbmVudCIsImNvbXBvbmVudFByb3BlcnR5TmFtZSIsImNoYXJBdCIsInRvTG93ZXJDYXNlIiwicXVlcnlLZXkiLCJDb21wb25lbnRzIiwibmFtZXMiLCJuIiwiVCIsIm9wZXJhdG9yIiwibWFwIiwieCIsImpvaW4iLCJRdWVyeSIsIm1hbmFnZXIiLCJOb3RDb21wb25lbnRzIiwiRXJyb3IiLCJlbnRpdGllcyIsImV2ZW50RGlzcGF0Y2hlciIsInJlYWN0aXZlIiwia2V5IiwiX2VudGl0aWVzIiwibWF0Y2giLCJkaXNwYXRjaEV2ZW50IiwicHJvdG90eXBlIiwiRU5USVRZX0FEREVEIiwiRU5USVRZX1JFTU9WRUQiLCJoYXNBbGxDb21wb25lbnRzIiwiaGFzQW55Q29tcG9uZW50cyIsIm51bUNvbXBvbmVudHMiLCJudW1FbnRpdGllcyIsIkNPTVBPTkVOVF9DSEFOR0VEIiwibmV4dElkIiwiRW50aXR5IiwiX3dvcmxkIiwiaWQiLCJfQ29tcG9uZW50VHlwZXMiLCJfY29tcG9uZW50cyIsIl9jb21wb25lbnRzVG9SZW1vdmUiLCJfQ29tcG9uZW50VHlwZXNUb1JlbW92ZSIsImFsaXZlIiwicXVlcnkiLCJ2YWx1ZXMiLCJlbnRpdHlBZGRDb21wb25lbnQiLCJmb3JjZVJlbW92ZSIsImVudGl0eVJlbW92ZUNvbXBvbmVudCIsImhhc0NvbXBvbmVudCIsImVudGl0eVJlbW92ZUFsbENvbXBvbmVudHMiLCJyZW1vdmVFbnRpdHkiLCJPYmplY3RQb29sIiwiaW5pdGlhbFNpemUiLCJmcmVlTGlzdCIsImNvdW50IiwiaXNPYmplY3RQb29sIiwiZXh0cmFBcmdzIiwiYXJndW1lbnRzIiwiQXJyYXkiLCJzaGlmdCIsImNyZWF0ZUVsZW1lbnQiLCJleHBhbmQiLCJNYXRoIiwicm91bmQiLCJwb3AiLCJpdGVtIiwicmVzZXQiLCJRdWVyeU1hbmFnZXIiLCJfcXVlcmllcyIsInF1ZXJ5TmFtZSIsImFkZEVudGl0eSIsIlN5c3RlbVN0YXRlQ29tcG9uZW50IiwiRW50aXR5TWFuYWdlciIsImNvbXBvbmVudHNNYW5hZ2VyIiwiX3F1ZXJ5TWFuYWdlciIsIl9lbnRpdHlQb29sIiwiZW50aXRpZXNXaXRoQ29tcG9uZW50c1RvUmVtb3ZlIiwiZW50aXRpZXNUb1JlbW92ZSIsIm51bVN0YXRlQ29tcG9uZW50cyIsImFxdWlyZSIsIkVOVElUWV9DUkVBVEVEIiwiX19wcm90b19fIiwiZ2V0Q29tcG9uZW50c1Bvb2wiLCJjb3B5Iiwib25FbnRpdHlDb21wb25lbnRBZGRlZCIsImNvbXBvbmVudEFkZGVkVG9FbnRpdHkiLCJDT01QT05FTlRfQURERUQiLCJpbW1lZGlhdGVseSIsIkNPTVBPTkVOVF9SRU1PVkUiLCJfZW50aXR5UmVtb3ZlQ29tcG9uZW50U3luYyIsImNvbXBvbmVudE5hbWUiLCJvbkVudGl0eUNvbXBvbmVudFJlbW92ZWQiLCJyZW1vdmUiLCJwcm9wTmFtZSIsIl9jb21wb25lbnRQb29sIiwicmVsZWFzZSIsImNvbXBvbmVudFJlbW92ZWRGcm9tRW50aXR5IiwiaiIsIm9uRW50aXR5UmVtb3ZlZCIsIl9yZWxlYXNlRW50aXR5IiwiZ2V0UXVlcnkiLCJudW1RdWVyaWVzIiwiT2JqZWN0Iiwia2V5cyIsIm51bUNvbXBvbmVudFBvb2wiLCJjb21wb25lbnRQb29sIiwiY25hbWUiLCJwb29sIiwidXNlZCIsInRvdGFsVXNlZCIsInNpemUiLCJEdW1teU9iamVjdFBvb2wiLCJpc0R1bW15T2JqZWN0UG9vbCIsIkluZmluaXR5IiwiQ29tcG9uZW50TWFuYWdlciIsImNvbnNvbGUiLCJ3YXJuIiwiY3JlYXRlVHlwZSIsInR5cGVEZWZpbml0aW9uIiwidW5kZWZpbmVkRnVuY3Rpb25zIiwiZmlsdGVyIiwiZiIsImlzVHlwZSIsIlR5cGVzIiwiTnVtYmVyIiwiYmFzZVR5cGUiLCJpc1NpbXBsZVR5cGUiLCJjcmVhdGUiLCJkZWZhdWx0VmFsdWUiLCJzcmMiLCJjbGVhciIsIkJvb2xlYW4iLCJTdHJpbmciLCJkc3QiLCJzdGFuZGFyZFR5cGVzIiwibnVtYmVyIiwiYm9vbGVhbiIsInN0cmluZyIsImluZmVyVHlwZSIsInZhbHVlIiwiaXNBcnJheSIsIl9tYW5kYXRvcnlRdWVyaWVzIiwicXVlcnlDb25maWciLCJjb21wb25lbnRzIiwiZW50aXR5TWFuYWdlciIsInF1ZXJ5Q29tcG9uZW50cyIsIm1hbmRhdG9yeSIsInJlc3VsdHMiLCJldmVudE1hcHBpbmciLCJhZGRlZCIsInJlbW92ZWQiLCJjaGFuZ2VkIiwibGlzdGVuIiwiZXZlbnQiLCJldmVudExpc3QiLCJhZGRFdmVudExpc3RlbmVyIiwiY2hhbmdlZENvbXBvbmVudCIsImpzb24iLCJzeXN0ZW1NYW5hZ2VyIiwiZXZlbnRRdWV1ZXMiLCJDdXN0b21FdmVudCIsImRldGFpbCIsIndpbmRvdyIsInJlZ2lzdGVyQ29tcG9uZW50IiwicmVnaXN0ZXJTeXN0ZW0iLCJTeXN0ZW1DbGFzcyIsImdldFN5c3RlbSIsImdldFN5c3RlbXMiLCJwcm9jZXNzRGVmZXJyZWRSZW1vdmFsIiwiY3JlYXRlRW50aXR5IiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsInNjaGVtYSIsInR5cGUiLCJkZWZhdWx0IiwiYXR0ciIsImRlZmluZVByb3BlcnR5Iiwia25vd25UeXBlcyJdLCJtYXBwaW5ncyI6IjhRQUFPLE1BQU1BLEVBQ1hDLFlBQVlDLEdBQ1ZDLEtBQUtDLFNBQVcsR0FDaEJELEtBQUtFLGdCQUFrQixHQUN2QkYsS0FBS0QsTUFBUUEsRUFDYkMsS0FBS0csbUJBQXFCLEtBRzVCTCxlQUFlTSxFQUFRQyxHQUNyQixJQUFJQyxFQUFTLElBQUlGLEVBQU9KLEtBQUtELE1BQU9NLEdBTXBDLE9BTElDLEVBQU9DLE1BQU1ELEVBQU9DLE9BQ3hCRCxFQUFPRSxNQUFRUixLQUFLQyxTQUFTUSxPQUM3QlQsS0FBS0MsU0FBU1MsS0FBS0osR0FDZkEsRUFBT0ssU0FBU1gsS0FBS0UsZ0JBQWdCUSxLQUFLSixHQUM5Q04sS0FBS1ksY0FDRVosS0FHVEYsY0FDRUUsS0FBS0UsZ0JBQWdCVyxLQUFLLENBQUNDLEVBQUdDLElBQ3JCRCxFQUFFRSxTQUFXRCxFQUFFQyxVQUFZRixFQUFFTixNQUFRTyxFQUFFUCxPQUlsRFYsVUFBVU0sR0FDUixPQUFPSixLQUFLQyxTQUFTZ0IsS0FBS0MsR0FBS0EsYUFBYWQsR0FHOUNOLGFBQ0UsT0FBT0UsS0FBS0MsU0FHZEgsYUFBYU0sR0FDWCxJQUFJZSxFQUFRbkIsS0FBS0MsU0FBU21CLFFBQVFoQixJQUM1QmUsR0FFTm5CLEtB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
